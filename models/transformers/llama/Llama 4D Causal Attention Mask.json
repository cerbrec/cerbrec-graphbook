{"name":"4D Causal Attention Mask","type":"COMPOSITE_OPERATION","inputs":[{"name":"Attention Mask","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Create Causal Attention Mask","type":"LOOP_OPERATION","position":{"x":416,"y":295},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Create Causal Attention Mask Init","type":"LOOP_INIT_OPERATION","position":{"x":300,"y":300},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Loop Data","primitive_name":"Loop Data","flow_state":"UNBOUND"},{"name":"Iteration","primitive_name":"Output (3)","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":555,"y":8},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","global_constant":"fp16_min"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","aliases":["shape","size","get_size"],"position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","aliases":["same"],"position":{"x":1134,"y":540},"inputs":[{"name":"input","data":2,"shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":560,"y":224},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","aliases":["shape","size","get_size"],"position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","aliases":["copy_cells_into_selected_indices"],"position":{"x":1211,"y":94},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_indices","data":[[0]],"shape":[1,1],"type":"INTEGER","primitive_name":"selected_indices","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Iteration"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Loop Data"},"control_points":[]}]},{"name":"Create Causal Attention Mask Loop Body","type":"LOOP_BODY_OPERATION","repeat_until_false_condition":{"name":"Run Again","loop_data":["Loop Data","Iteration"]},"position":{"x":734,"y":262},"inputs":[{"name":"Loop Data","primitive_name":"Loop Data"},{"name":"Iteration","primitive_name":"Output (3)"},{"name":"Input","primitive_name":"Input"}],"input_order":[2,0,1],"subgraph_input_order":[2,0,1],"outputs":[{"name":"Run Again","primitive_name":"Run Again","flow_state":"UNBOUND"},{"name":"Loop Data","primitive_name":"Loop Data","flow_state":"UNBOUND"},{"name":"Iteration","primitive_name":"Output (3)","flow_state":"UNBOUND"},{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"output_order":[0,3,1,2],"subgraph_output_order":[2,0,1],"operations":[{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","aliases":["plus","increment"],"position":{"x":769,"y":631},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["extend_one_dimension","increase_one_dimension"],"position":{"x":468,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["tile_to_shape","expand_to_shape","extend_to_shape"],"position":{"x":918,"y":341},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","aliases":["get_dim_size","get_dimensional_size","get_dim_length","get_dimension_length","get_dimensional_length"],"position":{"x":468,"y":92},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":918,"y":150},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["extend_one_dimension","increase_one_dimension"],"position":{"x":1265,"y":151},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["tile_to_shape","expand_to_shape","extend_to_shape"],"position":{"x":1611,"y":151},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","global_constant":"fp16_min"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","aliases":["concat","join","merge"],"position":{"x":1972,"y":302},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"input_order":[1,0,2],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_2","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["extend_one_dimension","increase_one_dimension"],"position":{"x":2339,"y":302},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","aliases":["concat","join","merge"],"position":{"x":2706,"y":92},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","aliases":["get_dim_size","get_dimensional_size","get_dim_length","get_dimension_length","get_dimensional_length"],"position":{"x":651,"y":875},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"add_1","primitive_name":"add","type":"PRIMITIVE_OPERATION","aliases":["plus","increment"],"position":{"x":1330,"y":881},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"less_than","primitive_name":"less_than","type":"PRIMITIVE_OPERATION","aliases":["lt","less","smaller","smaller_than"],"position":{"x":2708,"y":539},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_less_than","primitive_name":"is_less_than","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Iteration"},"sink":{"operation":"add","data":"left_operand"},"control_points":[{"x":420,"y":686}]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Iteration"},"control_points":[{"x":3047,"y":687}]},{"source":{"operation":"this","data":"Iteration"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Loop Data"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Iteration"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[{"x":198,"y":244}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Loop Data"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[{"x":256,"y":39},{"x":2610,"y":39}]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"expand_one_dimension_2","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_2","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Loop Data"},"control_points":[{"x":3266,"y":147}]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"less_than","data":"left_operand"},"control_points":[{"x":2640,"y":686}]},{"source":{"operation":"less_than","data":"is_less_than"},"sink":{"operation":"this","data":"Run Again"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"add_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_1","data":"added_result"},"sink":{"operation":"less_than","data":"right_operand"},"control_points":[{"x":2181,"y":632}]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Create Causal Attention Mask Init","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Create Causal Attention Mask Loop Body","data":"Input"},"control_points":[]},{"source":{"operation":"Create Causal Attention Mask Loop Body","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Create Causal Attention Mask Init","data":"Loop Data"},"sink":{"operation":"Create Causal Attention Mask Loop Body","data":"Loop Data"},"control_points":[]},{"source":{"operation":"Create Causal Attention Mask Init","data":"Iteration"},"sink":{"operation":"Create Causal Attention Mask Loop Body","data":"Iteration"},"control_points":[]}],"is_loop_toggled":true},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["extend_one_dimension","increase_one_dimension"],"position":{"x":1080,"y":294},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["extend_one_dimension","increase_one_dimension"],"position":{"x":1628,"y":294},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Get Expanded Attention Mask","type":"COMPOSITE_OPERATION","position":{"x":2009,"y":45},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Causal Mask","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["expand","expand_dimension","extend","extend_dimension","extend_one_dimension","increase_dimension","increase_one_dimension"],"position":{"x":384,"y":268},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","aliases":["expand","expand_dimension","extend","extend_dimension","extend_one_dimension","increase_dimension","increase_one_dimension"],"position":{"x":883,"y":268},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","aliases":["decimal"],"position":{"x":1354,"y":269},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1863,"y":54},"inputs":[{"name":"Scalar","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","aliases":["shape","size","get_size"],"position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1863,"y":403},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","aliases":["shape","size","get_size"],"position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":2363,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Causal Mask"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Causal Mask"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[{"x":323,"y":496}]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","aliases":["plus","increment"],"position":{"x":2455,"y":257},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"Get Expanded Attention Mask","data":"Output"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"Get Expanded Attention Mask","data":"Causal Mask"},"control_points":[]},{"source":{"operation":"this","data":"Attention Mask"},"sink":{"operation":"Get Expanded Attention Mask","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Attention Mask"},"sink":{"operation":"Create Causal Attention Mask","data":"Input"},"control_points":[]},{"source":{"operation":"Create Causal Attention Mask","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}],"global_constants":[{"name":"fp16_min","data":-65504.0,"shape":[],"type":"DECIMAL","primitive_name":"fp16_min"}]}