{"name":"SlimSAM Mask Decoder","type":"COMPOSITE_OPERATION","inputs":[{"name":"Sparse Prompt Enbedding","primitive_name":"Input"},{"name":"Positional Embedding","primitive_name":"Input (1)"},{"name":"Image Embedding","primitive_name":"Input (2)"}],"input_order":[2,1,0],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"iou_scores","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"Shape Inputs to Target Shape","type":"COMPOSITE_OPERATION","position":{"x":318,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"},{"name":"Image Embeddings","primitive_name":"Input (2)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"Output (1)","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"unsqueeze_2_949","primitive_name":"Output (2)","flow_state":"UNBOUND"}],"operations":[{"name":"Position Embedding Reshape","type":"COMPOSITE_OPERATION","position":{"x":662,"y":170},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"permute_1_18","type":"COMPOSITE_OPERATION","position":{"x":266,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":324,"y":116},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"swap_dimensions_1","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":792,"y":115},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"swap_dimensions_1","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions_1","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"unsqueeze_1_19","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"flatten_2_950","type":"COMPOSITE_OPERATION","position":{"x":1115,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":252,"y":237},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":663,"y":399},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1133,"y":395},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":928,"y":190},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[0,1],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1599,"y":188},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2058,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"permute_93_951","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1623,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"unsqueeze_3_952","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2037,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"permute_1_18","data":"Output"},"sink":{"operation":"unsqueeze_1_19","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"permute_1_18","data":"Input"},"control_points":[]},{"source":{"operation":"unsqueeze_1_19","data":"output"},"sink":{"operation":"flatten_2_950","data":"Input"},"control_points":[]},{"source":{"operation":"flatten_2_950","data":"Output"},"sink":{"operation":"permute_93_951","data":"array"},"control_points":[]},{"source":{"operation":"permute_93_951","data":"swapped_array"},"sink":{"operation":"unsqueeze_3_952","data":"input"},"control_points":[]},{"source":{"operation":"unsqueeze_3_952","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"identity_1","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":674,"y":316},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Embed Prompt","type":"COMPOSITE_OPERATION","position":{"x":660,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":330,"y":50},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_token/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":331,"y":232},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/mask_tokens/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":817,"y":104},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1310,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1721,"y":103},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2175,"y":403},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":346,"y":510}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"Position Embedding Reshape","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Image Embeddings"},"sink":{"operation":"identity_1","data":"input"},"control_points":[]},{"source":{"operation":"identity_1","data":"output"},"sink":{"operation":"this","data":"unsqueeze_2_949"},"control_points":[]},{"source":{"operation":"Position Embedding Reshape","data":"Output"},"sink":{"operation":"this","data":"Output (1)"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Embed Prompt","data":"Input"},"control_points":[]},{"source":{"operation":"Embed Prompt","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Mask Decoder Transformer","type":"COMPOSITE_OPERATION","position":{"x":842,"y":128},"inputs":[{"name":"to_17_943","primitive_name":"Input"},{"name":"unsqueeze_3_952","primitive_name":"Input"},{"name":"unsqueeze_2_949","primitive_name":"Input"}],"outputs":[{"name":"33_1105","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"32_1084","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"layers_0","type":"COMPOSITE_OPERATION","position":{"x":1108,"y":178},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"3_952","primitive_name":"Input (1)"},{"name":"2_949","primitive_name":"Input (2)"}],"outputs":[{"name":"28_1017","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"layernorm_27_996","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"layers_0_self_attn","type":"COMPOSITE_OPERATION","position":{"x":301,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":314,"y":41},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_50_954","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":374,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":373,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":196},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":779},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3343,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":395,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":374,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_50_954"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":318,"y":218},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_49_953","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"read_from_file_with_defined_shape","type":"COMPOSITE_OPERATION","position":{"x":416,"y":191},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":375,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":191},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":779},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"read_from_file_with_defined_shape (1)","type":"COMPOSITE_OPERATION","position":{"x":3338,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":354,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":464,"y":547}]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"read_from_file_with_defined_shape","data":"shape"},"control_points":[]},{"source":{"operation":"read_from_file_with_defined_shape","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"read_from_file_with_defined_shape (1)","data":"shape"},"control_points":[]},{"source":{"operation":"read_from_file_with_defined_shape (1)","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_49_953"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_167_958","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":794,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"reshape_166_956","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":793,"y":218},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_14_959","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1202,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"transpose_13_957","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1202,"y":218},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_94_962","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1623,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_27_963","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2107,"y":131},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2111,"y":546},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_51_955","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":459,"y":192},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":356,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":192},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3338,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":352,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_51_955"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_168_960","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2565,"y":546},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_15_961","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3074,"y":546},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"truediv_7_964","type":"COMPOSITE_OPERATION","position":{"x":2539,"y":131},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":5.656854152679443,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3018,"y":131},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Logits","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"Logits"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"matmul_28_966","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3531,"y":320},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3906,"y":320},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_169_968","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":4356,"y":320},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,1,7,256],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":4731,"y":320},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_51_955","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":414,"y":191},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":367,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3388,"y":380},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":356,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/self_attn/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_51_955"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"k proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"q proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_50_954"},"sink":{"operation":"reshape_167_958","data":"input"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_49_953"},"sink":{"operation":"reshape_166_956","data":"input"},"control_points":[]},{"source":{"operation":"reshape_167_958","data":"output"},"sink":{"operation":"transpose_14_959","data":"array"},"control_points":[]},{"source":{"operation":"reshape_166_956","data":"output"},"sink":{"operation":"transpose_13_957","data":"array"},"control_points":[]},{"source":{"operation":"transpose_14_959","data":"swapped_array"},"sink":{"operation":"permute_94_962","data":"array"},"control_points":[]},{"source":{"operation":"transpose_13_957","data":"swapped_array"},"sink":{"operation":"matmul_27_963","data":"left_operand"},"control_points":[]},{"source":{"operation":"permute_94_962","data":"swapped_array"},"sink":{"operation":"matmul_27_963","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"v proj","data":"to_17_943"},"control_points":[{"x":433,"y":611}]},{"source":{"operation":"v proj","data":"linear_51_955"},"sink":{"operation":"reshape_168_960","data":"input"},"control_points":[]},{"source":{"operation":"reshape_168_960","data":"output"},"sink":{"operation":"transpose_15_961","data":"array"},"control_points":[]},{"source":{"operation":"matmul_27_963","data":"multiplied_result"},"sink":{"operation":"truediv_7_964","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_7_964","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"Softmax","data":"Logits"},"sink":{"operation":"matmul_28_966","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_15_961","data":"swapped_array"},"sink":{"operation":"matmul_28_966","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_28_966","data":"multiplied_result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"reshape_169_968","data":"input"},"control_points":[]},{"source":{"operation":"reshape_169_968","data":"output"},"sink":{"operation":"out proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_51_955"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"layer_norm_25_970","type":"COMPOSITE_OPERATION","position":{"x":753,"y":41},"inputs":[{"name":"linear_52_969","primitive_name":"add_1_3"}],"outputs":[{"name":"layernorm_25_970","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":782,"y":294},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":45},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":255},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1961,"y":456},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":314,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"layernorm_25_970"},"control_points":[]},{"source":{"operation":"this","data":"linear_52_969"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"add_70_971","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1184,"y":173},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"add_71_972","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":505,"y":415},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layers_0_cross_attn_token_to_image","type":"COMPOSITE_OPERATION","position":{"x":1772,"y":373},"inputs":[{"name":"70_971","primitive_name":"Input"},{"name":"71_972","primitive_name":"Input (1)"},{"name":"unsqueeze_2_949","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":380,"y":41},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_53_973","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":635,"y":312},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":347,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3328,"y":436},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":344,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_53_973"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":376,"y":217},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_54_974","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":572,"y":304},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":357,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3337,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":339,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_54_974"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_171_978","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":834,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_18_979","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1285,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_95_982","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1726,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 1","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_170_976","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":836,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_17_977","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1729,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_29_983","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2186,"y":110},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"truediv_8_984","type":"COMPOSITE_OPERATION","position":{"x":2622,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":4.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3335,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"arg 0"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2187,"y":437},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_55_975","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":615,"y":283},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":332,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3342,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":349,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_55_975"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_172_980","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2622,"y":437},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_19_981","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3370,"y":437},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_30_986","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3824,"y":249},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"transpose_20_987","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":4210,"y":249},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_173_988","type":"COMPOSITE_OPERATION","position":{"x":4624,"y":249},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":196},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":818,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":819,"y":193},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[1],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1207,"y":370},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1671,"y":190},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2145,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2505,"y":40},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2865,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":5048,"y":249},"inputs":[{"name":"173_988","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_56_989","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":250,"y":98},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,128],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":563,"y":386},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":353,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2866,"y":422},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":779},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3449,"y":595},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":332,"y":67},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3917,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_56_989"},"control_points":[]},{"source":{"operation":"this","data":"173_988"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"71_972"},"sink":{"operation":"k proj","data":"70_971"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"q proj","data":"70_971"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_54_974"},"sink":{"operation":"reshape_171_978","data":"input"},"control_points":[]},{"source":{"operation":"reshape_171_978","data":"output"},"sink":{"operation":"transpose_18_979","data":"array"},"control_points":[]},{"source":{"operation":"transpose_18_979","data":"swapped_array"},"sink":{"operation":"permute_95_982","data":"array"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_53_973"},"sink":{"operation":"reshape_170_976","data":"input"},"control_points":[]},{"source":{"operation":"reshape_170_976","data":"output"},"sink":{"operation":"transpose_17_977","data":"array"},"control_points":[]},{"source":{"operation":"transpose_17_977","data":"arg 0"},"sink":{"operation":"matmul_29_983","data":"left_operand"},"control_points":[]},{"source":{"operation":"permute_95_982","data":"arg 1"},"sink":{"operation":"matmul_29_983","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_29_983","data":"multiplied_result"},"sink":{"operation":"truediv_8_984","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_8_984","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"unsqueeze_2_949"},"sink":{"operation":"v proj","data":"70_971"},"control_points":[{"x":671,"y":502}]},{"source":{"operation":"v proj","data":"linear_55_975"},"sink":{"operation":"reshape_172_980","data":"input"},"control_points":[]},{"source":{"operation":"reshape_172_980","data":"output"},"sink":{"operation":"transpose_19_981","data":"array"},"control_points":[]},{"source":{"operation":"Softmax","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_19_981","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_30_986","data":"multiplied_result"},"sink":{"operation":"transpose_20_987","data":"array"},"control_points":[]},{"source":{"operation":"transpose_20_987","data":"swapped_array"},"sink":{"operation":"reshape_173_988","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_173_988","data":"Output"},"sink":{"operation":"out proj","data":"173_988"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_56_989"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add_72_990","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2522,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_26_991","type":"COMPOSITE_OPERATION","position":{"x":2888,"y":41},"inputs":[{"name":"72_990","primitive_name":"add_1_3"}],"outputs":[{"name":"26_991","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Parameter With Optimizer (bias)","type":"COMPOSITE_OPERATION","position":{"x":1931,"y":458},"inputs":[{"name":"Weight Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Pretrain Directory exist_in_files","primitive_name":"exist_in_files","type":"PRIMITIVE_OPERATION","position":{"x":218,"y":588},"inputs":[{"name":"Pretrain Dir","data":"${Pretrain Directory (Read Only)}//layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_exist","primitive_name":"is_exist","flow_state":"UNBOUND"}]},{"name":"logical_and","primitive_name":"logical_and","type":"PRIMITIVE_OPERATION","position":{"x":598,"y":546},"inputs":[{"name":"Wants Read","shape":[],"type":"BOOLEAN","primitive_name":"condition_1","global_constant":"Start From Pretrained"},{"name":"condition_2","primitive_name":"condition_2"}],"outputs":[{"name":"Should Read","primitive_name":"new_condition","flow_state":"UNBOUND"}]},{"name":"Data Type Is Integer","primitive_name":"Data Type Is Integer","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":423,"y":43},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]},{"name":"Is 1D Array","primitive_name":"Has One Dimension","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":423,"y":162},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]},{"name":"Train Directory exist_in_files","primitive_name":"exist_in_files","type":"PRIMITIVE_OPERATION","position":{"x":739,"y":212},"inputs":[{"name":"Train Dir","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","shape":[],"type":"TEXT","primitive_name":"file_name","global_constant":"Training Weight File Name"}],"outputs":[{"name":"is_exist","primitive_name":"is_exist","flow_state":"UNBOUND"}]},{"name":"Initialially Read from Pretrained If True","type":"CONDITIONAL_OPERATION","position":{"x":1180,"y":324},"inputs":[{"name":"Is True (Train Dir Exists)","primitive_name":"Is True"},{"name":"Weight Shape","primitive_name":"Input"},{"name":"Do Read Pretrain","primitive_name":"Input"}],"outputs":[{"name":"Weight","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"First Init","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"read from training directory","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":438,"y":72},"inputs":[{"name":"train dir","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","shape":[],"type":"TEXT","primitive_name":"file_name","global_constant":"Training Weight File Name"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":944,"y":308},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":1424,"y":634},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":40},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":138},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":137},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"logical_not","primitive_name":"logical_not","type":"PRIMITIVE_OPERATION","position":{"x":1880,"y":634},"inputs":[{"name":"condition","primitive_name":"condition"}],"outputs":[{"name":"Is New Shape","primitive_name":"new_condition","flow_state":"UNBOUND"}]},{"name":"logical_and","primitive_name":"logical_and","type":"PRIMITIVE_OPERATION","position":{"x":2299,"y":697},"inputs":[{"name":"condition_1","primitive_name":"condition_1"},{"name":"condition_2","primitive_name":"condition_2"}],"outputs":[{"name":"read pre","primitive_name":"new_condition","flow_state":"UNBOUND"}]},{"name":"If True, Read From Pretrained","type":"CONDITIONAL_OPERATION","position":{"x":3067,"y":30},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Train Weight","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"delete_folder","primitive_name":"delete_folder","type":"PRIMITIVE_OPERATION","position":{"x":922,"y":312},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"}],"outputs":[]},{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":886,"y":43},"inputs":[{"name":"PreTrain Dir","data":"${Pretrain Directory (Read Only)}//layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":147},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Train Weight"},"sink":{"operation":"identity","data":"input"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"logical_not_2","primitive_name":"logical_not","type":"PRIMITIVE_OPERATION","position":{"x":1902,"y":915},"inputs":[{"name":"condition","primitive_name":"condition"}],"outputs":[{"name":"new_condition","primitive_name":"new_condition","flow_state":"UNBOUND"}]},{"name":"logical_and_1","primitive_name":"logical_and","type":"PRIMITIVE_OPERATION","position":{"x":2303,"y":873},"inputs":[{"name":"condition_1","primitive_name":"condition_1"},{"name":"condition_2","primitive_name":"condition_2"}],"outputs":[{"name":"do init","primitive_name":"new_condition","flow_state":"UNBOUND"}]},{"name":"If True, Read From Init","type":"CONDITIONAL_OPERATION","position":{"x":3755,"y":30},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Weight","primitive_name":"Input"},{"name":"Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"Get Random Number Limits","type":"COMPOSITE_OPERATION","position":{"x":436,"y":234},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Left Limit","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"Right Limit","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":307,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":42},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":1085,"y":120},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1590,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2299,"y":121},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":-1.0,"shape":[],"type":"DECIMAL","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"this","data":"Left Limit"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"this","data":"Right Limit"},"control_points":[{"x":2191,"y":293},{"x":2702,"y":293}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]}]},{"name":"generate_uniform_random_number","primitive_name":"generate_uniform_random_number","type":"PRIMITIVE_OPERATION","position":{"x":1107,"y":97},"inputs":[{"name":"shape","primitive_name":"shape"},{"name":"random_seed","data":10,"shape":[],"type":"INTEGER","primitive_name":"random_seed","flow_state":"BOOT_SOURCE"},{"name":"left_limit","primitive_name":"left_limit"},{"name":"right_limit","primitive_name":"right_limit"}],"outputs":[{"name":"random_number","primitive_name":"random_number","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"Get Random Number Limits","data":"Left Limit"},"sink":{"operation":"generate_uniform_random_number","data":"left_limit"},"control_points":[]},{"source":{"operation":"Get Random Number Limits","data":"Right Limit"},"sink":{"operation":"generate_uniform_random_number","data":"right_limit"},"control_points":[]},{"source":{"operation":"this","data":"Shape"},"sink":{"operation":"Get Random Number Limits","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Shape"},"sink":{"operation":"generate_uniform_random_number","data":"shape"},"control_points":[]},{"source":{"operation":"generate_uniform_random_number","data":"random_number"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":779,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight"},"sink":{"operation":"identity","data":"input"},"control_points":[]}],"condition":{"name":"Is True"}}],"links_if_true":[{"source":{"operation":"read from training directory","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":928,"y":738}]},{"source":{"operation":"this","data":"Do Read Pretrain"},"sink":{"operation":"logical_and","data":"condition_2"},"control_points":[{"x":931,"y":801}]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"logical_not","data":"condition"},"control_points":[]},{"source":{"operation":"logical_not","data":"Is New Shape"},"sink":{"operation":"logical_and","data":"condition_1"},"control_points":[]},{"source":{"operation":"read from training directory","data":"output"},"sink":{"operation":"If True, Read From Pretrained","data":"Train Weight"},"control_points":[]},{"source":{"operation":"logical_and","data":"read pre"},"sink":{"operation":"If True, Read From Pretrained","data":"Is True"},"control_points":[]},{"source":{"operation":"logical_not","data":"Is New Shape"},"sink":{"operation":"logical_and_1","data":"condition_1"},"control_points":[]},{"source":{"operation":"logical_not_2","data":"new_condition"},"sink":{"operation":"logical_and_1","data":"condition_2"},"control_points":[]},{"source":{"operation":"this","data":"Do Read Pretrain"},"sink":{"operation":"logical_not_2","data":"condition"},"control_points":[{"x":1150,"y":977}]},{"source":{"operation":"logical_and_1","data":"do init"},"sink":{"operation":"If True, Read From Init","data":"Is True"},"control_points":[{"x":3142,"y":935}]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"If True, Read From Init","data":"Shape"},"control_points":[{"x":618,"y":489},{"x":3456,"y":489}]},{"source":{"operation":"If True, Read From Pretrained","data":"Output"},"sink":{"operation":"If True, Read From Init","data":"Weight"},"control_points":[]},{"source":{"operation":"If True, Read From Init","data":"Output"},"sink":{"operation":"this","data":"Weight"},"control_points":[]},{"source":{"operation":"logical_and_1","data":"do init"},"sink":{"operation":"this","data":"First Init"},"control_points":[{"x":3806,"y":933}]}],"operations_if_false":[{"name":"Read From Pretrain Dir If Exists Else Init","type":"CONDITIONAL_OPERATION","position":{"x":372,"y":44},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Weight Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":404,"y":62},"inputs":[{"name":"PreTrain Dir","data":"${Pretrain Directory (Read Only)}//layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":866,"y":300},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1358,"y":425},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links_if_true":[{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":495,"y":532}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]}],"operations_if_false":[{"name":"Get Random Number Limits","type":"COMPOSITE_OPERATION","position":{"x":277,"y":131},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Left Limit","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"Right Limit","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":307,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":42},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":1085,"y":120},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1590,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2299,"y":121},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":-1.0,"shape":[],"type":"DECIMAL","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"this","data":"Left Limit"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"this","data":"Right Limit"},"control_points":[{"x":2191,"y":293},{"x":2702,"y":293}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]}]},{"name":"generate_uniform_random_number","primitive_name":"generate_uniform_random_number","type":"PRIMITIVE_OPERATION","position":{"x":962,"y":43},"inputs":[{"name":"shape","primitive_name":"shape"},{"name":"random_seed","data":10,"shape":[],"type":"INTEGER","primitive_name":"random_seed","flow_state":"BOOT_SOURCE"},{"name":"left_limit","primitive_name":"left_limit"},{"name":"right_limit","primitive_name":"right_limit"}],"outputs":[{"name":"random_number","primitive_name":"random_number","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"Get Random Number Limits","data":"Left Limit"},"sink":{"operation":"generate_uniform_random_number","data":"left_limit"},"control_points":[]},{"source":{"operation":"Get Random Number Limits","data":"Right Limit"},"sink":{"operation":"generate_uniform_random_number","data":"right_limit"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Get Random Number Limits","data":"Input"},"control_points":[]},{"source":{"operation":"generate_uniform_random_number","data":"random_number"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"generate_uniform_random_number","data":"shape"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"logical_not","primitive_name":"logical_not","type":"PRIMITIVE_OPERATION","position":{"x":418,"y":348},"inputs":[{"name":"Is read pretrain","primitive_name":"condition"}],"outputs":[{"name":"is first init","primitive_name":"new_condition","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Do Read Pretrain"},"sink":{"operation":"Read From Pretrain Dir If Exists Else Init","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Read From Pretrain Dir If Exists Else Init","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Read From Pretrain Dir If Exists Else Init","data":"Output"},"sink":{"operation":"this","data":"Weight"},"control_points":[]},{"source":{"operation":"this","data":"Do Read Pretrain"},"sink":{"operation":"logical_not","data":"Is read pretrain"},"control_points":[]},{"source":{"operation":"logical_not","data":"is first init"},"sink":{"operation":"this","data":"First Init"},"control_points":[]}],"condition":{"name":"Is True (Train Dir Exists)"}},{"name":"Differentiate and Optimize If Train","type":"CONDITIONAL_OPERATION","position":{"x":1722,"y":282},"inputs":[{"name":"Is Train","shape":[],"type":"BOOLEAN","primitive_name":"Is True","global_constant":"Is Train"},{"name":"Weight","primitive_name":"Input (2)"},{"name":"First Iteration","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":740,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Read/Initialize Timestep t","type":"COMPOSITE_OPERATION","position":{"x":326,"y":719},"inputs":[{"name":"Initial t","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"exist_in_files","primitive_name":"exist_in_files","type":"PRIMITIVE_OPERATION","position":{"x":402,"y":106},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Timestep for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_exist","primitive_name":"is_exist","flow_state":"UNBOUND"}]},{"name":"Read/Initialize Timestep t","type":"CONDITIONAL_OPERATION","position":{"x":944,"y":107},"inputs":[{"name":"Is Initialize","primitive_name":"Is True"},{"name":"Initial t","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"Read Timestep t","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":623,"y":43},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Timestep for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"Read Timestep t","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":520,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"write_to_file","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":229},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Timestep for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"write_to_file","data":"data"},"control_points":[]},{"source":{"operation":"this","data":"Initial t"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is Initialize"}}],"links":[{"source":{"operation":"exist_in_files","data":"is_exist"},"sink":{"operation":"Read/Initialize Timestep t","data":"Is Initialize"},"control_points":[]},{"source":{"operation":"this","data":"Initial t"},"sink":{"operation":"Read/Initialize Timestep t","data":"Initial t"},"control_points":[{"x":316,"y":362},{"x":813,"y":362}]},{"source":{"operation":"Read/Initialize Timestep t","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":498,"y":461},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"differentiate","primitive_name":"differentiate","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":934},"inputs":[{"name":"wrt_input","data":["SlimSAM Mask Decoder","Mask Decoder Transformer","layers_0","layer_norm_26_991","layernorm_1_4","Element-wise Linear Layer","Parameter With Optimizer (bias)","Differentiate and Optimize If Train","identity","input"],"shape":[12],"type":"TEXT","primitive_name":"wrt_input","flow_state":"BOOT_SOURCE"},{"name":"function_output","data":["SlimSAM Mask Decoder","Mask Decoder Transformer","layers_0","layer_norm_26_991","layernorm_1_4","Element-wise Linear Layer","Parameter With Optimizer (bias)","Differentiate and Optimize If Train","subtract","subtracted_result"],"shape":[12],"type":"TEXT","primitive_name":"function_output","flow_state":"BOOT_SOURCE"},{"name":"order","data":1,"shape":[],"type":"INTEGER","primitive_name":"order","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"derivative","primitive_name":"derivative","flow_state":"UNBOUND"}]},{"name":"Reinitialize Timestep And DIff","type":"CONDITIONAL_OPERATION","position":{"x":914,"y":534},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Differentiate","primitive_name":"Input"},{"name":"Timestep","primitive_name":"Input"},{"name":"Weight Shape","primitive_name":"Input"}],"outputs":[{"name":"Timestep","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"diff passed","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":540,"y":63},"inputs":[{"name":"input","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":533,"y":244},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Timestep"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"diff passed"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1274,"y":221},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"identity_1","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1272,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Timestep"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Timestep"},"control_points":[]},{"source":{"operation":"this","data":"Differentiate"},"sink":{"operation":"identity_1","data":"input"},"control_points":[]},{"source":{"operation":"identity_1","data":"output"},"sink":{"operation":"this","data":"diff passed"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"Increment","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1588,"y":832},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"write_to_file_1","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":2096,"y":706},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Timestep for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]},{"name":"Adam Optimizer","type":"COMPOSITE_OPERATION","position":{"x":1564,"y":359},"inputs":[{"name":"Alpha","shape":[],"type":"DECIMAL","primitive_name":"new_inp","global_constant":"Learning Rate"},{"name":"Beta 1","data":0.9,"shape":[],"type":"DECIMAL","primitive_name":"i_0_Adam Optimizer","flow_state":"BOOT_SOURCE"},{"name":"Beta 2","data":0.999,"shape":[],"type":"DECIMAL","primitive_name":"i_0_Adam Optimizer","flow_state":"BOOT_SOURCE"},{"name":"g (t)","primitive_name":"i_0_Adam Optimizer"},{"name":"t","primitive_name":"i_0_Adam Optimizer"},{"name":"Epsilon","data":1e-07,"shape":[],"type":"DECIMAL","primitive_name":"i_0_Adam Optimizer","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Gradients","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"Compute first moment estimate","type":"COMPOSITE_OPERATION","position":{"x":693,"y":161},"inputs":[{"name":"Beta 1","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"g (t)","primitive_name":"Input (1)"},{"name":"t","primitive_name":"Input (2)"}],"outputs":[{"name":"m (t)^","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Update biased first moment estimate","type":"COMPOSITE_OPERATION","position":{"x":584,"y":114},"inputs":[{"name":"Beta 1","shape":[],"type":"DECIMAL","primitive_name":"new_inp","flow_state":"BOOT_SINK"},{"name":"g (t)","primitive_name":"i_1_Update biased first moment estimate"}],"outputs":[{"name":"m (t)","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":457,"y":301},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","shape":[],"type":"DECIMAL","primitive_name":"right_operand","flow_state":"BOOT_SINK"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":1348,"y":387},"inputs":[{"name":"Target","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply_1","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1917,"y":633},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":458,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Read/Initialize m (t - 1)","type":"COMPOSITE_OPERATION","position":{"x":855,"y":181},"inputs":[{"name":"Initialize Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"exist_in_files","primitive_name":"exist_in_files","type":"PRIMITIVE_OPERATION","position":{"x":403,"y":92},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased First Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_exist","primitive_name":"is_exist","flow_state":"UNBOUND"}]},{"name":"Read/Initialize m (t - 1)","type":"CONDITIONAL_OPERATION","position":{"x":931,"y":93},"inputs":[{"name":"Is Inititialize","primitive_name":"Is True"},{"name":"Initialize Shape","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":469,"y":42},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased First Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":964,"y":328},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":1444,"y":650},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":40},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":138},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":137},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Rebroadcast If False","type":"CONDITIONAL_OPERATION","position":{"x":2422,"y":817},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Shape To Broad","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":757,"y":156},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":659,"y":229},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Shape To Broad"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links_if_true":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":846,"y":760}]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Rebroadcast If False","data":"Is True"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Rebroadcast If False","data":"Input"},"control_points":[{"x":1904,"y":105}]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"Rebroadcast If False","data":"Shape To Broad"},"control_points":[{"x":1076,"y":968}]},{"source":{"operation":"Rebroadcast If False","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":588,"y":46},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is Inititialize"}}],"links":[{"source":{"operation":"exist_in_files","data":"is_exist"},"sink":{"operation":"Read/Initialize m (t - 1)","data":"Is Inititialize"},"control_points":[]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"Read/Initialize m (t - 1)","data":"Initialize Shape"},"control_points":[{"x":286,"y":318},{"x":807,"y":318}]},{"source":{"operation":"Read/Initialize m (t - 1)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1342,"y":48},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":350},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":47},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1916,"y":48},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2641,"y":48},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"Write m (t)","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":3075,"y":227},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased First Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"element_wise_multiply_1","data":"right_array"},"control_points":[{"x":548,"y":740}]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"element_wise_multiply_1","data":"multiplied_array"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"m (t)"},"control_points":[]},{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[{"x":246,"y":36},{"x":1258,"y":36}]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[{"x":1254,"y":364}]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[{"x":376,"y":494}]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_multiply_1","data":"left_array"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"Write m (t)","data":"data"},"control_points":[]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Read/Initialize m (t - 1)","data":"Output"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Read/Initialize m (t - 1)","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[{"x":1793,"y":244}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Read/Initialize m (t - 1)","data":"Initialize Shape"},"control_points":[]}]},{"name":"Compute bias-corrected first moment estimate","type":"COMPOSITE_OPERATION","position":{"x":1332,"y":114},"inputs":[{"name":"m (t)","primitive_name":"new_inp"},{"name":"Beta 1","shape":[],"type":"DECIMAL","primitive_name":"i_0_Compute bias-corrected first moment estimate","flow_state":"BOOT_SINK"},{"name":"t","primitive_name":"i_0_Compute bias-corrected first moment estimate"}],"outputs":[{"name":"m (t)^","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":442,"y":422},"inputs":[{"name":"base","shape":[],"type":"DECIMAL","primitive_name":"base","flow_state":"BOOT_SINK"},{"name":"exponent","primitive_name":"exponent"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":978,"y":378},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1542,"y":334},"inputs":[{"name":"Target","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":350},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":46},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2122,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_operand"},{"name":"right_array","primitive_name":"right_operand"}],"outputs":[{"name":"divided_array","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"element_wise_exponentiate","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"m (t)"},"sink":{"operation":"element_wise_divide","data":"left_array"},"control_points":[]},{"source":{"operation":"element_wise_divide","data":"divided_array"},"sink":{"operation":"this","data":"m (t)^"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"m (t)"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[{"x":1320,"y":106}]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_divide","data":"right_array"},"control_points":[]}]}],"links":[{"source":{"operation":"Update biased first moment estimate","data":"m (t)"},"sink":{"operation":"Compute bias-corrected first moment estimate","data":"m (t)"},"control_points":[]},{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"Update biased first moment estimate","data":"Beta 1"},"control_points":[{"x":497,"y":106}]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Update biased first moment estimate","data":"g (t)"},"control_points":[{"x":503,"y":160}]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"Compute bias-corrected first moment estimate","data":"t"},"control_points":[{"x":317,"y":478},{"x":1111,"y":478}]},{"source":{"operation":"Compute bias-corrected first moment estimate","data":"m (t)^"},"sink":{"operation":"this","data":"m (t)^"},"control_points":[]},{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"Compute bias-corrected first moment estimate","data":"Beta 1"},"control_points":[{"x":1217,"y":106}]}]},{"name":"Compute second moment estimate","type":"COMPOSITE_OPERATION","position":{"x":667,"y":531},"inputs":[{"name":"Beta 2","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"g (t)","primitive_name":"Input (1)"},{"name":"t","primitive_name":"Input (1)"}],"outputs":[{"name":"v (t)^","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Update biased second moment estimate","type":"COMPOSITE_OPERATION","position":{"x":510,"y":114},"inputs":[{"name":"Beta 2","shape":[],"type":"DECIMAL","primitive_name":"new_inp","flow_state":"BOOT_SINK"},{"name":"g (t)","primitive_name":"i_0_Update biased second raw moment estimate"}],"outputs":[{"name":"v (t)","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":816,"y":387},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","shape":[],"type":"DECIMAL","primitive_name":"right_operand","flow_state":"BOOT_SINK"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":1294,"y":387},"inputs":[{"name":"Target","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply_1","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1316,"y":683},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"element_wise_multiply_2","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1797,"y":639},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":173},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Read v (t - 1)","type":"COMPOSITE_OPERATION","position":{"x":860,"y":232},"inputs":[{"name":"Initialize Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"exist_in_files","primitive_name":"exist_in_files","type":"PRIMITIVE_OPERATION","position":{"x":456,"y":149},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased Second Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_exist","primitive_name":"is_exist","flow_state":"UNBOUND"}]},{"name":"Read v (t - 1)","type":"CONDITIONAL_OPERATION","position":{"x":1158,"y":150},"inputs":[{"name":"Is Initialize","primitive_name":"Is True"},{"name":"Initialize Shape","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":562,"y":44},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased Second Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1022,"y":292},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":1380,"y":466},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":40},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":138},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":137},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Rebroadcast If False","type":"CONDITIONAL_OPERATION","position":{"x":2305,"y":624},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Shape To Broad","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":757,"y":156},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":659,"y":229},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Shape To Broad"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links_if_true":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Rebroadcast If False","data":"Is True"},"control_points":[{"x":2072,"y":529}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":592,"y":573}]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"Rebroadcast If False","data":"Shape To Broad"},"control_points":[{"x":785,"y":776}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Rebroadcast If False","data":"Input"},"control_points":[{"x":1627,"y":107}]},{"source":{"operation":"Rebroadcast If False","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":500,"y":46},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is Initialize"}}],"links":[{"source":{"operation":"exist_in_files","data":"is_exist"},"sink":{"operation":"Read v (t - 1)","data":"Is Initialize"},"control_points":[]},{"source":{"operation":"this","data":"Initialize Shape"},"sink":{"operation":"Read v (t - 1)","data":"Initialize Shape"},"control_points":[{"x":360,"y":458},{"x":947,"y":458}]},{"source":{"operation":"Read v (t - 1)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1294,"y":43},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":350},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":47},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":144},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2337,"y":144},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"Write v (t)","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":2829,"y":270},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"Biased Second Moment Estimate for Training","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]}],"links":[{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"element_wise_multiply_2","data":"multiplied_array"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"v (t)"},"control_points":[{"x":2774,"y":101}]},{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[{"x":481,"y":494}]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[{"x":434,"y":546},{"x":1241,"y":546}]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"element_wise_multiply_1","data":"right_array"},"control_points":[{"x":672,"y":790}]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"element_wise_multiply_1","data":"left_array"},"control_points":[{"x":634,"y":746}]},{"source":{"operation":"element_wise_multiply_1","data":"multiplied_array"},"sink":{"operation":"element_wise_multiply_2","data":"right_array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_multiply_2","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":132,"y":236}]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"Write v (t)","data":"data"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Read v (t - 1)","data":"Initialize Shape"},"control_points":[]},{"source":{"operation":"Read v (t - 1)","data":"Output"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Read v (t - 1)","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[{"x":1714,"y":295}]}]},{"name":"Compute bias-corrected second moment estimate","type":"COMPOSITE_OPERATION","position":{"x":1292,"y":114},"inputs":[{"name":"v (t)","primitive_name":"new_inp"},{"name":"Beta 2","shape":[],"type":"DECIMAL","primitive_name":"i_0_Compute bias-corrected first moment estimate","flow_state":"BOOT_SINK"},{"name":"t","primitive_name":"i_0_Compute bias-corrected first moment estimate"}],"outputs":[{"name":"v (t)^","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":420,"y":419},"inputs":[{"name":"base","shape":[],"type":"DECIMAL","primitive_name":"base","flow_state":"BOOT_SINK"},{"name":"exponent","primitive_name":"exponent"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":381},"inputs":[{"name":"left_operand","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"left_operand","flow_state":"BOOT_SOURCE"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1535,"y":342},"inputs":[{"name":"Target","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2089,"y":46},"inputs":[{"name":"left_array","primitive_name":"left_operand"},{"name":"right_array","primitive_name":"right_operand"}],"outputs":[{"name":"divided_array","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"element_wise_exponentiate","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"v (t)"},"sink":{"operation":"element_wise_divide","data":"left_array"},"control_points":[]},{"source":{"operation":"element_wise_divide","data":"divided_array"},"sink":{"operation":"this","data":"v (t)^"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"v (t)"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[{"x":1396,"y":101}]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_divide","data":"right_array"},"control_points":[]}]}],"links":[{"source":{"operation":"Update biased second moment estimate","data":"v (t)"},"sink":{"operation":"Compute bias-corrected second moment estimate","data":"v (t)"},"control_points":[]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Update biased second moment estimate","data":"g (t)"},"control_points":[{"x":418,"y":160}]},{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"Update biased second moment estimate","data":"Beta 2"},"control_points":[{"x":416,"y":106}]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"Compute bias-corrected second moment estimate","data":"t"},"control_points":[{"x":327,"y":392},{"x":1170,"y":392}]},{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"Compute bias-corrected second moment estimate","data":"Beta 2"},"control_points":[{"x":1171,"y":106}]},{"source":{"operation":"Compute bias-corrected second moment estimate","data":"v (t)^"},"sink":{"operation":"this","data":"v (t)^"},"control_points":[]}]},{"name":"Get gradients","type":"COMPOSITE_OPERATION","position":{"x":1620,"y":117},"inputs":[{"name":"Alpha","shape":[],"type":"DECIMAL","primitive_name":"new_inp","flow_state":"BOOT_SINK"},{"name":"m (t)^","primitive_name":"i_0_Get gradients"},{"name":"v (t)^","primitive_name":"i_0_Get gradients"},{"name":"Epsilon","shape":[],"type":"DECIMAL","primitive_name":"i_0_Get gradients","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Gradients","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":551,"y":42},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1089,"y":172},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":552,"y":433},"inputs":[{"name":"Target","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1088,"y":400},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (2)","type":"COMPOSITE_OPERATION","position":{"x":552,"y":652},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1722,"y":400},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"element_wise_divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2265,"y":171},"inputs":[{"name":"left_array","primitive_name":"left_operand"},{"name":"right_array","primitive_name":"right_operand"}],"outputs":[{"name":"divided_array","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"m (t)^"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[{"x":441,"y":265}]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"element_wise_divide","data":"left_array"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"element_wise_divide","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_divide","data":"divided_array"},"sink":{"operation":"this","data":"Gradients"},"control_points":[]},{"source":{"operation":"this","data":"v (t)^"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[{"x":350,"y":365},{"x":982,"y":365}]},{"source":{"operation":"this","data":"Alpha"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"m (t)^"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"v (t)^"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate","data":"exponent"},"control_points":[]},{"source":{"operation":"this","data":"Epsilon"},"sink":{"operation":"Broadcast Target to Shape of Array (2)","data":"Target"},"control_points":[{"x":348,"y":744}]},{"source":{"operation":"this","data":"v (t)^"},"sink":{"operation":"Broadcast Target to Shape of Array (2)","data":"Array"},"control_points":[{"x":351,"y":706}]},{"source":{"operation":"Broadcast Target to Shape of Array (2)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[{"x":1546,"y":709}]}]}],"links":[{"source":{"operation":"this","data":"Alpha"},"sink":{"operation":"Get gradients","data":"Alpha"},"control_points":[{"x":1466,"y":106}]},{"source":{"operation":"Get gradients","data":"Gradients"},"sink":{"operation":"this","data":"Gradients"},"control_points":[]},{"source":{"operation":"this","data":"Epsilon"},"sink":{"operation":"Get gradients","data":"Epsilon"},"control_points":[{"x":557,"y":821},{"x":1306,"y":821}]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"Compute first moment estimate","data":"t"},"control_points":[]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Compute first moment estimate","data":"g (t)"},"control_points":[]},{"source":{"operation":"this","data":"Beta 1"},"sink":{"operation":"Compute first moment estimate","data":"Beta 1"},"control_points":[{"x":630,"y":160}]},{"source":{"operation":"Compute first moment estimate","data":"m (t)^"},"sink":{"operation":"Get gradients","data":"m (t)^"},"control_points":[]},{"source":{"operation":"Compute second moment estimate","data":"v (t)^"},"sink":{"operation":"Get gradients","data":"v (t)^"},"control_points":[]},{"source":{"operation":"this","data":"Beta 2"},"sink":{"operation":"Compute second moment estimate","data":"Beta 2"},"control_points":[{"x":506,"y":594}]},{"source":{"operation":"this","data":"g (t)"},"sink":{"operation":"Compute second moment estimate","data":"g (t)"},"control_points":[{"x":492,"y":638}]},{"source":{"operation":"this","data":"t"},"sink":{"operation":"Compute second moment estimate","data":"t"},"control_points":[{"x":479,"y":682}]}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2076,"y":317},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"write_to_file","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":2534,"y":416},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"${QTraining Weight File NameE}","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]}],"links_if_true":[{"source":{"operation":"Adam Optimizer","data":"Gradients"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"write_to_file","data":"data"},"control_points":[]},{"source":{"operation":"Increment","data":"added_result"},"sink":{"operation":"write_to_file_1","data":"data"},"control_points":[]},{"source":{"operation":"this","data":"Weight"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"First Iteration"},"sink":{"operation":"Reinitialize Timestep And DIff","data":"Is True"},"control_points":[{"x":336,"y":595}]},{"source":{"operation":"Read/Initialize Timestep t","data":"Output"},"sink":{"operation":"Reinitialize Timestep And DIff","data":"Timestep"},"control_points":[]},{"source":{"operation":"Reinitialize Timestep And DIff","data":"Timestep"},"sink":{"operation":"Adam Optimizer","data":"t"},"control_points":[]},{"source":{"operation":"Reinitialize Timestep And DIff","data":"Timestep"},"sink":{"operation":"Increment","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Weight"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":341,"y":523}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Reinitialize Timestep And DIff","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Reinitialize Timestep And DIff","data":"diff passed"},"sink":{"operation":"Adam Optimizer","data":"g (t)"},"control_points":[]},{"source":{"operation":"differentiate","data":"derivative"},"sink":{"operation":"Reinitialize Timestep And DIff","data":"Differentiate"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":414,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Save Weight To Train Dir","type":"CONDITIONAL_OPERATION","position":{"x":426,"y":252},"inputs":[{"name":"Is True","shape":[],"type":"BOOLEAN","primitive_name":"Is True","global_constant":"Is Train"},{"name":"Input","primitive_name":"Input"}],"outputs":[],"operations_if_true":[{"name":"write_to_file","primitive_name":"write_to_file","type":"PRIMITIVE_OPERATION","position":{"x":552,"y":108},"inputs":[{"name":"dir_path","data":"${Training Directory}/layers/0/layer_norm1/layers/0/layer_norm1/layer_norm_bias/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"${QTraining Weight File NameE}","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"is_overwrite","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"is_overwrite","flow_state":"BOOT_SOURCE"},{"name":"data","primitive_name":"data"}],"outputs":[]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"write_to_file","data":"data"},"control_points":[]}],"operations_if_false":[],"links_if_false":[],"condition":{"name":"Is True"}}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Weight"},"sink":{"operation":"Save Weight To Train Dir","data":"Input"},"control_points":[]}],"condition":{"name":"Is Train"}}],"links":[{"source":{"operation":"Differentiate and Optimize If Train","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Pretrain Directory exist_in_files","data":"is_exist"},"sink":{"operation":"logical_and","data":"condition_2"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Initialially Read from Pretrained If True","data":"Weight Shape"},"control_points":[{"x":578,"y":428}]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Data Type Is Integer","data":"variable"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Is 1D Array","data":"variable"},"control_points":[]},{"source":{"operation":"logical_and","data":"Should Read"},"sink":{"operation":"Initialially Read from Pretrained If True","data":"Do Read Pretrain"},"control_points":[]},{"source":{"operation":"Train Directory exist_in_files","data":"is_exist"},"sink":{"operation":"Initialially Read from Pretrained If True","data":"Is True (Train Dir Exists)"},"control_points":[]},{"source":{"operation":"Initialially Read from Pretrained If True","data":"Weight"},"sink":{"operation":"Differentiate and Optimize If Train","data":"Weight"},"control_points":[]},{"source":{"operation":"Initialially Read from Pretrained If True","data":"First Init"},"sink":{"operation":"Differentiate and Optimize If Train","data":"First Iteration"},"control_points":[]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":728,"y":395},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":363,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":259},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1972,"y":641},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":351,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":431},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Parameter With Optimizer (bias)","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"26_991"},"control_points":[]},{"source":{"operation":"this","data":"72_990"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"mlp","type":"COMPOSITE_OPERATION","position":{"x":3307,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"linear_57_992","type":"COMPOSITE_OPERATION","position":{"x":299,"y":41},"inputs":[{"name":"reshape_2_9","primitive_name":"reshape_2_9"}],"outputs":[{"name":"output","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[2048,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":457,"y":253},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":332,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/mlp/lin1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3390,"y":502},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":348,"y":50},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/mlp/lin1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"output"},"control_points":[]},{"source":{"operation":"this","data":"reshape_2_9"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"ReLU_1_993","type":"COMPOSITE_OPERATION","position":{"x":791,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"linear_58_994","type":"COMPOSITE_OPERATION","position":{"x":1246,"y":41},"inputs":[{"name":"input","primitive_name":"reshape_2_9"}],"outputs":[{"name":"output","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,2048],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":404,"y":254},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":318,"y":50},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/mlp/lin2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3357,"y":387},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":316,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/mlp/lin2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"output"},"control_points":[]},{"source":{"operation":"this","data":"input"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"linear_57_992","data":"reshape_2_9"},"control_points":[]},{"source":{"operation":"linear_57_992","data":"output"},"sink":{"operation":"ReLU_1_993","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU_1_993","data":"Output"},"sink":{"operation":"linear_58_994","data":"input"},"control_points":[]},{"source":{"operation":"linear_58_994","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add_73_995","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3716,"y":189},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_27_996","type":"COMPOSITE_OPERATION","position":{"x":4064,"y":189},"inputs":[{"name":"73_995","primitive_name":"add_1_3"}],"outputs":[{"name":"27_996","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":753,"y":315},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm3/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":276},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":2084,"y":455},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":370,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm3/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"27_996"},"control_points":[]},{"source":{"operation":"this","data":"73_995"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"add_74_997","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4461,"y":-18},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"add_75_998","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4303,"y":570},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layers_0_cross_attn_image_to_token","type":"COMPOSITE_OPERATION","position":{"x":4849,"y":105},"inputs":[{"name":"74_997","primitive_name":"Input"},{"name":"75_998","primitive_name":"Input (1)"},{"name":"27_996","primitive_name":"Input"}],"outputs":[{"name":"62_1015","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":380,"y":41},"inputs":[{"name":"74_997","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_60_1000","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":414,"y":248},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":333,"y":37},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":761,"y":235},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3351,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":330,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_60_1000"},"control_points":[]},{"source":{"operation":"this","data":"74_997"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":376,"y":217},"inputs":[{"name":"75_998","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_59_999","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":409,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3383,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":377,"y":84},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_59_999"},"control_points":[]},{"source":{"operation":"this","data":"75_998"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_174_1002","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":834,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_21_1003","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1731,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_175_1004","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":836,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_22_1005","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1294,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2187,"y":437},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_55_975","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":439,"y":192},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":352,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3417,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":349,"y":36},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_55_975"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_172_980","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2622,"y":437},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_19_981","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3045,"y":437},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_96_1008","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1733,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 1","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_29_983","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2186,"y":110},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"truediv_8_984","type":"COMPOSITE_OPERATION","position":{"x":2569,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":4.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3010,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"arg 0"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"matmul_30_986","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3499,"y":249},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"transpose_20_987","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3885,"y":249},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_173_988","type":"COMPOSITE_OPERATION","position":{"x":4299,"y":249},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":196},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":818,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":819,"y":193},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[1],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1207,"y":370},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1671,"y":190},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2145,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2505,"y":40},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2865,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":4723,"y":249},"inputs":[{"name":"173_988","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_56_989","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,128],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":441,"y":193},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":341,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3366,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":356,"y":60},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/cross_attn_image_to_token/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_56_989"},"control_points":[]},{"source":{"operation":"this","data":"173_988"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"75_998"},"sink":{"operation":"q proj","data":"75_998"},"control_points":[]},{"source":{"operation":"this","data":"74_997"},"sink":{"operation":"k proj","data":"74_997"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_59_999"},"sink":{"operation":"reshape_174_1002","data":"input"},"control_points":[]},{"source":{"operation":"reshape_174_1002","data":"output"},"sink":{"operation":"transpose_21_1003","data":"array"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_60_1000"},"sink":{"operation":"reshape_175_1004","data":"input"},"control_points":[]},{"source":{"operation":"reshape_175_1004","data":"output"},"sink":{"operation":"transpose_22_1005","data":"array"},"control_points":[]},{"source":{"operation":"matmul_29_983","data":"multiplied_result"},"sink":{"operation":"truediv_8_984","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_8_984","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"27_996"},"sink":{"operation":"v proj","data":"70_971"},"control_points":[{"x":671,"y":502}]},{"source":{"operation":"v proj","data":"linear_55_975"},"sink":{"operation":"reshape_172_980","data":"input"},"control_points":[]},{"source":{"operation":"reshape_172_980","data":"output"},"sink":{"operation":"transpose_19_981","data":"array"},"control_points":[]},{"source":{"operation":"Softmax","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_19_981","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_30_986","data":"multiplied_result"},"sink":{"operation":"transpose_20_987","data":"array"},"control_points":[]},{"source":{"operation":"transpose_20_987","data":"swapped_array"},"sink":{"operation":"reshape_173_988","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_173_988","data":"Output"},"sink":{"operation":"out proj","data":"173_988"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_56_989"},"sink":{"operation":"this","data":"62_1015"},"control_points":[]},{"source":{"operation":"transpose_22_1005","data":"arg 0"},"sink":{"operation":"permute_96_1008","data":"array"},"control_points":[]},{"source":{"operation":"permute_96_1008","data":"arg 1"},"sink":{"operation":"matmul_29_983","data":"right_operand"},"control_points":[]},{"source":{"operation":"transpose_21_1003","data":"swapped_array"},"sink":{"operation":"matmul_29_983","data":"left_operand"},"control_points":[]}]},{"name":"add_76_1016","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5351,"y":234},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_28_1017","type":"COMPOSITE_OPERATION","position":{"x":5736,"y":234},"inputs":[{"name":"76_1016","primitive_name":"add_1_3"}],"outputs":[{"name":"28_1017","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":293,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":311},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":549},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":269},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":549},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":549},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":677},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":746,"y":294},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":38},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm4/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":252},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":41},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":2022,"y":455},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":328,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/0/layer_norm4/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":413},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":106}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"28_1017"},"control_points":[]},{"source":{"operation":"this","data":"76_1016"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"layers_0_self_attn","data":"Input"},"control_points":[]},{"source":{"operation":"layers_0_self_attn","data":"Output"},"sink":{"operation":"layer_norm_25_970","data":"linear_52_969"},"control_points":[]},{"source":{"operation":"layer_norm_25_970","data":"layernorm_25_970"},"sink":{"operation":"add_70_971","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"add_70_971","data":"right_operand"},"control_points":[{"x":513,"y":280}]},{"source":{"operation":"this","data":"3_952"},"sink":{"operation":"add_71_972","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"2_949"},"sink":{"operation":"add_71_972","data":"right_operand"},"control_points":[]},{"source":{"operation":"add_70_971","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"70_971"},"control_points":[]},{"source":{"operation":"add_71_972","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"71_972"},"control_points":[]},{"source":{"operation":"this","data":"2_949"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"unsqueeze_2_949"},"control_points":[{"x":357,"y":592},{"x":1356,"y":592}]},{"source":{"operation":"layer_norm_25_970","data":"layernorm_25_970"},"sink":{"operation":"add_72_990","data":"left_operand"},"control_points":[]},{"source":{"operation":"layers_0_cross_attn_token_to_image","data":"Output"},"sink":{"operation":"add_72_990","data":"right_operand"},"control_points":[]},{"source":{"operation":"add_72_990","data":"added_result"},"sink":{"operation":"layer_norm_26_991","data":"72_990"},"control_points":[]},{"source":{"operation":"layer_norm_26_991","data":"26_991"},"sink":{"operation":"mlp","data":"Input"},"control_points":[]},{"source":{"operation":"mlp","data":"Output"},"sink":{"operation":"add_73_995","data":"left_operand"},"control_points":[]},{"source":{"operation":"layer_norm_26_991","data":"26_991"},"sink":{"operation":"add_73_995","data":"right_operand"},"control_points":[{"x":3281,"y":296}]},{"source":{"operation":"add_73_995","data":"added_result"},"sink":{"operation":"layer_norm_27_996","data":"73_995"},"control_points":[]},{"source":{"operation":"layer_norm_27_996","data":"27_996"},"sink":{"operation":"add_74_997","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"add_74_997","data":"left_operand"},"control_points":[{"x":377,"y":0},{"x":2607,"y":0}]},{"source":{"operation":"add_74_997","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"74_997"},"control_points":[]},{"source":{"operation":"this","data":"3_952"},"sink":{"operation":"add_75_998","data":"left_operand"},"control_points":[{"x":327,"y":635}]},{"source":{"operation":"this","data":"2_949"},"sink":{"operation":"add_75_998","data":"right_operand"},"control_points":[{"x":258,"y":677}]},{"source":{"operation":"add_75_998","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"75_998"},"control_points":[]},{"source":{"operation":"layer_norm_27_996","data":"27_996"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"27_996"},"control_points":[]},{"source":{"operation":"this","data":"2_949"},"sink":{"operation":"add_76_1016","data":"right_operand"},"control_points":[{"x":453,"y":341},{"x":2929,"y":341}]},{"source":{"operation":"layers_0_cross_attn_image_to_token","data":"62_1015"},"sink":{"operation":"add_76_1016","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_76_1016","data":"added_result"},"sink":{"operation":"layer_norm_28_1017","data":"76_1016"},"control_points":[]},{"source":{"operation":"layer_norm_28_1017","data":"28_1017"},"sink":{"operation":"this","data":"28_1017"},"control_points":[]},{"source":{"operation":"layer_norm_27_996","data":"27_996"},"sink":{"operation":"this","data":"layernorm_27_996"},"control_points":[{"x":4733,"y":508},{"x":5891,"y":508}]}]},{"name":"add_77_1018","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1628,"y":629},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layers_1","type":"COMPOSITE_OPERATION","position":{"x":2136,"y":461},"inputs":[{"name":"77_1018","primitive_name":"Input"},{"name":"3_952","primitive_name":"Input (1)"},{"name":"27_996","primitive_name":"Input"},{"name":"28_1017","primitive_name":"Input"},{"name":"17_943","primitive_name":"Input"}],"input_order":[3,2,4,1,0],"subgraph_input_order":[3,0,1,2,4],"outputs":[{"name":"32_1084","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"31_1063","primitive_name":"Output","flow_state":"UNBOUND"}],"subgraph_output_order":[3,0,1,2,4],"operations":[{"name":"layers_0_self_attn","type":"COMPOSITE_OPERATION","position":{"x":406,"y":1},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"layernorm_27_996","primitive_name":"Input (1)"}],"outputs":[{"name":"66_1035","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":314,"y":43},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_50_954","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":367,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":290,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3336,"y":382},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":304,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_50_954"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":312,"y":220},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_49_953","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":394,"y":198},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":302,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3363,"y":385},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":284,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_49_953"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_167_958","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":794,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"reshape_166_956","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":794,"y":220},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_14_959","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1202,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"transpose_13_957","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1200,"y":220},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_94_962","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1623,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_27_963","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2107,"y":131},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2111,"y":550},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_51_955","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":420,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":319,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":814,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1244,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":469,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3317,"y":382},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":300,"y":69},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_51_955"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_168_960","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2565,"y":550},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,32],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_15_961","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3074,"y":550},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"truediv_7_964","type":"COMPOSITE_OPERATION","position":{"x":2539,"y":131},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":5.656854152679443,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3018,"y":131},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Logits","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"Logits"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"matmul_28_966","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3531,"y":320},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3906,"y":320},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_169_968","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":4356,"y":320},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,1,7,256],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":4731,"y":320},"inputs":[{"name":"to_17_943","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_51_955","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":446,"y":195},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":325,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3349,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":335,"y":77},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/self_attn/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_51_955"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"k proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"q proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_50_954"},"sink":{"operation":"reshape_167_958","data":"input"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_49_953"},"sink":{"operation":"reshape_166_956","data":"input"},"control_points":[]},{"source":{"operation":"reshape_167_958","data":"output"},"sink":{"operation":"transpose_14_959","data":"array"},"control_points":[]},{"source":{"operation":"reshape_166_956","data":"output"},"sink":{"operation":"transpose_13_957","data":"array"},"control_points":[]},{"source":{"operation":"transpose_14_959","data":"swapped_array"},"sink":{"operation":"permute_94_962","data":"array"},"control_points":[]},{"source":{"operation":"transpose_13_957","data":"swapped_array"},"sink":{"operation":"matmul_27_963","data":"left_operand"},"control_points":[]},{"source":{"operation":"permute_94_962","data":"swapped_array"},"sink":{"operation":"matmul_27_963","data":"right_operand"},"control_points":[]},{"source":{"operation":"v proj","data":"linear_51_955"},"sink":{"operation":"reshape_168_960","data":"input"},"control_points":[]},{"source":{"operation":"reshape_168_960","data":"output"},"sink":{"operation":"transpose_15_961","data":"array"},"control_points":[]},{"source":{"operation":"matmul_27_963","data":"multiplied_result"},"sink":{"operation":"truediv_7_964","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_7_964","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"Softmax","data":"Logits"},"sink":{"operation":"matmul_28_966","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_15_961","data":"swapped_array"},"sink":{"operation":"matmul_28_966","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_28_966","data":"multiplied_result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"reshape_169_968","data":"input"},"control_points":[]},{"source":{"operation":"reshape_169_968","data":"output"},"sink":{"operation":"out proj","data":"to_17_943"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_51_955"},"sink":{"operation":"this","data":"66_1035"},"control_points":[]},{"source":{"operation":"this","data":"layernorm_27_996"},"sink":{"operation":"v proj","data":"to_17_943"},"control_points":[{"x":413,"y":612}]}]},{"name":"add_78_1036","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":872,"y":155},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_29_1037","type":"COMPOSITE_OPERATION","position":{"x":1250,"y":43},"inputs":[{"name":"78_1036","primitive_name":"add_1_3"}],"outputs":[{"name":"29_1037","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":746,"y":271},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":42},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":229},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1856,"y":468},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":320,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":429},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"29_1037"},"control_points":[]},{"source":{"operation":"this","data":"78_1036"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"add_79_1038","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1616,"y":207},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"add_80_1039","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":420},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layers_0_cross_attn_token_to_image","type":"COMPOSITE_OPERATION","position":{"x":1974,"y":378},"inputs":[{"name":"67_1040","primitive_name":"Input"},{"name":"68_1041","primitive_name":"Input (1)"},{"name":"28_1017","primitive_name":"Input"}],"outputs":[{"name":"70_1056","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":380,"y":43},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_67_1040","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":502,"y":192},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":303,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3365,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":335,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_67_1040"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":376,"y":217},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_68_1041","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":480,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":332,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3336,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":348,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_68_1041"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_171_978","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":834,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_18_979","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1285,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_95_982","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1726,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 1","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_170_976","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":836,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_17_977","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1729,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_29_983","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2186,"y":110},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"truediv_8_984","type":"COMPOSITE_OPERATION","position":{"x":2569,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":4.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3010,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"arg 0"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2187,"y":440},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_55_975","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":463,"y":191},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":337,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3288,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":360,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_55_975"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_172_980","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2622,"y":440},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_19_981","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3045,"y":440},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_30_986","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3499,"y":249},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"transpose_20_987","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3885,"y":249},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_173_988","type":"COMPOSITE_OPERATION","position":{"x":4299,"y":249},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":196},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":818,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":819,"y":193},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[1],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1207,"y":370},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1671,"y":190},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2145,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2505,"y":40},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2865,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":4723,"y":249},"inputs":[{"name":"173_988","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_56_989","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,128],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":521,"y":194},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":350,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3378,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":360,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_56_989"},"control_points":[]},{"source":{"operation":"this","data":"173_988"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"68_1041"},"sink":{"operation":"k proj","data":"70_971"},"control_points":[]},{"source":{"operation":"this","data":"67_1040"},"sink":{"operation":"q proj","data":"70_971"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_68_1041"},"sink":{"operation":"reshape_171_978","data":"input"},"control_points":[]},{"source":{"operation":"reshape_171_978","data":"output"},"sink":{"operation":"transpose_18_979","data":"array"},"control_points":[]},{"source":{"operation":"transpose_18_979","data":"swapped_array"},"sink":{"operation":"permute_95_982","data":"array"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_67_1040"},"sink":{"operation":"reshape_170_976","data":"input"},"control_points":[]},{"source":{"operation":"reshape_170_976","data":"output"},"sink":{"operation":"transpose_17_977","data":"array"},"control_points":[]},{"source":{"operation":"transpose_17_977","data":"arg 0"},"sink":{"operation":"matmul_29_983","data":"left_operand"},"control_points":[]},{"source":{"operation":"permute_95_982","data":"arg 1"},"sink":{"operation":"matmul_29_983","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_29_983","data":"multiplied_result"},"sink":{"operation":"truediv_8_984","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_8_984","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"28_1017"},"sink":{"operation":"v proj","data":"70_971"},"control_points":[{"x":671,"y":502}]},{"source":{"operation":"v proj","data":"linear_55_975"},"sink":{"operation":"reshape_172_980","data":"input"},"control_points":[]},{"source":{"operation":"reshape_172_980","data":"output"},"sink":{"operation":"transpose_19_981","data":"array"},"control_points":[]},{"source":{"operation":"Softmax","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_19_981","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_30_986","data":"multiplied_result"},"sink":{"operation":"transpose_20_987","data":"array"},"control_points":[]},{"source":{"operation":"transpose_20_987","data":"swapped_array"},"sink":{"operation":"reshape_173_988","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_173_988","data":"Output"},"sink":{"operation":"out proj","data":"173_988"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_56_989"},"sink":{"operation":"this","data":"70_1056"},"control_points":[]}]},{"name":"add_80_1057","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2398,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_30_1058","type":"COMPOSITE_OPERATION","position":{"x":2754,"y":43},"inputs":[{"name":"72_990","primitive_name":"add_1_3"}],"outputs":[{"name":"30_1058","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1902,"y":455},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":323,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":741,"y":302},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":48},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":260},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"30_1058"},"control_points":[]},{"source":{"operation":"this","data":"72_990"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"mlp","type":"COMPOSITE_OPERATION","position":{"x":3102,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"linear_57_992","type":"COMPOSITE_OPERATION","position":{"x":299,"y":43},"inputs":[{"name":"reshape_2_9","primitive_name":"reshape_2_9"}],"outputs":[{"name":"output","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[2048,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":458,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":313,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/mlp/lin1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3347,"y":382},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":314,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/mlp/lin1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":750,"y":248},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"output"},"control_points":[]},{"source":{"operation":"this","data":"reshape_2_9"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"ReLU_1_993","type":"COMPOSITE_OPERATION","position":{"x":791,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"linear_58_994","type":"COMPOSITE_OPERATION","position":{"x":1246,"y":43},"inputs":[{"name":"input","primitive_name":"reshape_2_9"}],"outputs":[{"name":"output","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,2048],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":428,"y":201},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":324,"y":53},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/mlp/lin2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3352,"y":380},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":318,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/mlp/lin2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"output"},"control_points":[]},{"source":{"operation":"this","data":"input"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"linear_57_992","data":"reshape_2_9"},"control_points":[]},{"source":{"operation":"linear_57_992","data":"output"},"sink":{"operation":"ReLU_1_993","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU_1_993","data":"Output"},"sink":{"operation":"linear_58_994","data":"input"},"control_points":[]},{"source":{"operation":"linear_58_994","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add_82_1062","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3504,"y":189},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_31_1063","type":"COMPOSITE_OPERATION","position":{"x":3884,"y":189},"inputs":[{"name":"82_1062","primitive_name":"add_1_3"}],"outputs":[{"name":"31_1063","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":760,"y":293},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":326,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm3/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":254},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1910,"y":458},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":325,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm3/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"31_1063"},"control_points":[]},{"source":{"operation":"this","data":"82_1062"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]},{"name":"add83_1064","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4288,"y":-57},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"add_84_1065","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4062,"y":553},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layers_0_cross_attn_image_to_token","type":"COMPOSITE_OPERATION","position":{"x":4676,"y":105},"inputs":[{"name":"83_1064","primitive_name":"Input"},{"name":"84_1065","primitive_name":"Input (1)"},{"name":"31_1063","primitive_name":"Input"}],"outputs":[{"name":"76_1082","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":380,"y":43},"inputs":[{"name":"74_997","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_74_1067","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":446,"y":193},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":364,"y":61},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3330,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":314,"y":48},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_74_1067"},"control_points":[]},{"source":{"operation":"this","data":"74_997"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":376,"y":217},"inputs":[{"name":"75_998","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_73_1066","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":431,"y":200},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":360,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3318,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":361,"y":78},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":779,"y":280},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_73_1066"},"control_points":[]},{"source":{"operation":"this","data":"75_998"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_174_1002","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":834,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"reshape_175_1004","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":836,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_22_1005","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1294,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2187,"y":440},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_55_975","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":532,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":350,"y":46},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3322,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":303,"y":56},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_55_975"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_172_980","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2622,"y":440},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_31_1048","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3045,"y":440},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"transpose_22_1006","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1285,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_98_10410","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1727,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_29_983","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2186,"y":110},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"truediv_8_984","type":"COMPOSITE_OPERATION","position":{"x":2569,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":4.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax_17_1052","type":"COMPOSITE_OPERATION","position":{"x":3010,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"arg 0"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"matmul_30_986","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3499,"y":249},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"transpose_20_987","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3885,"y":249},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_173_988","type":"COMPOSITE_OPERATION","position":{"x":4299,"y":249},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":196},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":818,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":819,"y":193},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[1],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1207,"y":370},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1671,"y":190},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2145,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2505,"y":40},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2865,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"out_proj","type":"COMPOSITE_OPERATION","position":{"x":4723,"y":249},"inputs":[{"name":"173_988","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_56_989","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,128],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":357,"y":192},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":332,"y":68},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1385,"y":139},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3354,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":298,"y":42},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/cross_attn_image_to_token/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_56_989"},"control_points":[]},{"source":{"operation":"this","data":"173_988"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"84_1065"},"sink":{"operation":"q proj","data":"75_998"},"control_points":[]},{"source":{"operation":"this","data":"83_1064"},"sink":{"operation":"k proj","data":"74_997"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_73_1066"},"sink":{"operation":"reshape_174_1002","data":"input"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_74_1067"},"sink":{"operation":"reshape_175_1004","data":"input"},"control_points":[]},{"source":{"operation":"reshape_175_1004","data":"output"},"sink":{"operation":"transpose_22_1005","data":"array"},"control_points":[]},{"source":{"operation":"matmul_29_983","data":"multiplied_result"},"sink":{"operation":"truediv_8_984","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_8_984","data":"Output"},"sink":{"operation":"Softmax_17_1052","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"31_1063"},"sink":{"operation":"v proj","data":"70_971"},"control_points":[{"x":671,"y":502}]},{"source":{"operation":"v proj","data":"linear_55_975"},"sink":{"operation":"reshape_172_980","data":"input"},"control_points":[]},{"source":{"operation":"reshape_172_980","data":"output"},"sink":{"operation":"transpose_31_1048","data":"array"},"control_points":[]},{"source":{"operation":"Softmax_17_1052","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_31_1048","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_30_986","data":"multiplied_result"},"sink":{"operation":"transpose_20_987","data":"array"},"control_points":[]},{"source":{"operation":"transpose_20_987","data":"swapped_array"},"sink":{"operation":"reshape_173_988","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_173_988","data":"Output"},"sink":{"operation":"out_proj","data":"173_988"},"control_points":[]},{"source":{"operation":"out_proj","data":"linear_56_989"},"sink":{"operation":"this","data":"76_1082"},"control_points":[]},{"source":{"operation":"reshape_174_1002","data":"output"},"sink":{"operation":"transpose_22_1006","data":"array"},"control_points":[]},{"source":{"operation":"transpose_22_1005","data":"arg 0"},"sink":{"operation":"permute_98_10410","data":"array"},"control_points":[]},{"source":{"operation":"permute_98_10410","data":"swapped_array"},"sink":{"operation":"matmul_29_983","data":"right_operand"},"control_points":[]},{"source":{"operation":"transpose_22_1006","data":"arg 0"},"sink":{"operation":"matmul_29_983","data":"left_operand"},"control_points":[]}]},{"name":"add_85_1083","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5178,"y":234},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_32_1084","type":"COMPOSITE_OPERATION","position":{"x":5562,"y":234},"inputs":[{"name":"76_1016","primitive_name":"add_1_3"}],"outputs":[{"name":"28_1017","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":736,"y":292},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":313,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm4/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":250},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1695,"y":456},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":296,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layers/1/layer_norm4/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":744,"y":250},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"28_1017"},"control_points":[]},{"source":{"operation":"this","data":"76_1016"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"77_1018"},"sink":{"operation":"layers_0_self_attn","data":"Input"},"control_points":[]},{"source":{"operation":"layer_norm_29_1037","data":"29_1037"},"sink":{"operation":"add_79_1038","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_79_1038","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"67_1040"},"control_points":[]},{"source":{"operation":"layer_norm_29_1037","data":"29_1037"},"sink":{"operation":"add_80_1057","data":"left_operand"},"control_points":[]},{"source":{"operation":"layers_0_cross_attn_token_to_image","data":"70_1056"},"sink":{"operation":"add_80_1057","data":"right_operand"},"control_points":[]},{"source":{"operation":"add_80_1057","data":"added_result"},"sink":{"operation":"layer_norm_30_1058","data":"72_990"},"control_points":[]},{"source":{"operation":"layer_norm_30_1058","data":"30_1058"},"sink":{"operation":"mlp","data":"Input"},"control_points":[]},{"source":{"operation":"mlp","data":"Output"},"sink":{"operation":"add_82_1062","data":"left_operand"},"control_points":[]},{"source":{"operation":"layer_norm_30_1058","data":"30_1058"},"sink":{"operation":"add_82_1062","data":"right_operand"},"control_points":[{"x":3189,"y":296}]},{"source":{"operation":"add_82_1062","data":"added_result"},"sink":{"operation":"layer_norm_31_1063","data":"82_1062"},"control_points":[]},{"source":{"operation":"layer_norm_31_1063","data":"31_1063"},"sink":{"operation":"add83_1064","data":"right_operand"},"control_points":[]},{"source":{"operation":"add83_1064","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"83_1064"},"control_points":[]},{"source":{"operation":"layers_0_cross_attn_image_to_token","data":"76_1082"},"sink":{"operation":"add_85_1083","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_85_1083","data":"added_result"},"sink":{"operation":"layer_norm_32_1084","data":"76_1016"},"control_points":[]},{"source":{"operation":"layer_norm_32_1084","data":"28_1017"},"sink":{"operation":"this","data":"32_1084"},"control_points":[]},{"source":{"operation":"layer_norm_31_1063","data":"31_1063"},"sink":{"operation":"this","data":"31_1063"},"control_points":[{"x":4547,"y":467},{"x":5859,"y":467}]},{"source":{"operation":"layers_0_self_attn","data":"66_1035"},"sink":{"operation":"add_78_1036","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"27_996"},"sink":{"operation":"add_78_1036","data":"right_operand"},"control_points":[]},{"source":{"operation":"add_78_1036","data":"added_result"},"sink":{"operation":"layer_norm_29_1037","data":"78_1036"},"control_points":[]},{"source":{"operation":"this","data":"28_1017"},"sink":{"operation":"add_80_1039","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"3_952"},"sink":{"operation":"add_80_1039","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"17_943"},"sink":{"operation":"add_79_1038","data":"right_operand"},"control_points":[]},{"source":{"operation":"add_80_1039","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"68_1041"},"control_points":[]},{"source":{"operation":"this","data":"28_1017"},"sink":{"operation":"layers_0_cross_attn_token_to_image","data":"28_1017"},"control_points":[{"x":1087,"y":527}]},{"source":{"operation":"this","data":"17_943"},"sink":{"operation":"add83_1064","data":"left_operand"},"control_points":[{"x":1385,"y":8},{"x":2245,"y":8}]},{"source":{"operation":"this","data":"28_1017"},"sink":{"operation":"add_84_1065","data":"left_operand"},"control_points":[{"x":655,"y":618}]},{"source":{"operation":"this","data":"3_952"},"sink":{"operation":"add_84_1065","data":"right_operand"},"control_points":[{"x":579,"y":660}]},{"source":{"operation":"add_84_1065","data":"added_result"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"84_1065"},"control_points":[]},{"source":{"operation":"layer_norm_31_1063","data":"31_1063"},"sink":{"operation":"layers_0_cross_attn_image_to_token","data":"31_1063"},"control_points":[]},{"source":{"operation":"this","data":"28_1017"},"sink":{"operation":"add_85_1083","data":"right_operand"},"control_points":[{"x":947,"y":173},{"x":1719,"y":173},{"x":2669,"y":341}]},{"source":{"operation":"this","data":"27_996"},"sink":{"operation":"layers_0_self_attn","data":"layernorm_27_996"},"control_points":[]}]},{"name":"add_87_1086","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2629,"y":93},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"add_86_1085","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":2760,"y":817},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer 3: final_token_to_image","type":"COMPOSITE_OPERATION","position":{"x":3664,"y":278},"inputs":[{"name":"86_1085","primitive_name":"Input"},{"name":"87_1086","primitive_name":"Input (1)"},{"name":"79_1089","primitive_name":"Input"}],"outputs":[{"name":"80_1103","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"q proj","type":"COMPOSITE_OPERATION","position":{"x":380,"y":41},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_77_1087","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":473,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":352,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3332,"y":384},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":333,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/q_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_77_1087"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"k proj","type":"COMPOSITE_OPERATION","position":{"x":376,"y":217},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_78_1088","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":478,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":366,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3260,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":319,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/k_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_78_1088"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_171_978","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":834,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_18_979","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1285,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"permute_95_982","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1726,"y":217},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 1","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_170_976","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":836,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,7,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_17_977","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1729,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_29_983","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2186,"y":110},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"truediv_8_984","type":"COMPOSITE_OPERATION","position":{"x":2569,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","data":4.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Softmax","type":"COMPOSITE_OPERATION","position":{"x":3010,"y":110},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dim Index","data":3,"shape":[],"type":"INTEGER","primitive_name":"Dim Index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"Logits","flow_state":"UNBOUND"}],"operations":[{"name":"Get Shape for Logits","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":450,"y":437},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape"}]},{"name":"Broadcast Euler's Number to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1322,"y":400},"inputs":[{"name":"Euler's Number","data":2.71828,"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","aliases":["broadcast","tile","tile_to_shape"],"position":{"x":926,"y":173},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","aliases":["minus","decrement"],"position":{"x":1322,"y":46},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result"}]},{"name":"Element-wise Exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1832,"y":45},"inputs":[{"name":"Base","primitive_name":"base"},{"name":"Exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"Exponentiation","primitive_name":"exponentiation"}]},{"name":"Sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2298,"y":374},"inputs":[{"name":"Exponentiation","primitive_name":"array"},{"name":"Dim Index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Summed Result","primitive_name":"sum_result"}]},{"name":"Broadcast Summed Denominator to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2933,"y":373},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Result","primitive_name":"result"}]},{"name":"Element-wise Divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":3482,"y":45},"inputs":[{"name":"Left Operand","primitive_name":"left_operand"},{"name":"Right Operand","primitive_name":"right_operand"}],"outputs":[{"name":"Result","primitive_name":"divided_result"}]},{"name":"maximum","primitive_name":"maximum","type":"PRIMITIVE_OPERATION","aliases":["max"],"position":{"x":452,"y":170},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"maximum_result","primitive_name":"maximum_result"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Get Shape for Logits","data":"Input"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Euler's Number to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Euler's Number to Shape","data":"Result"},"sink":{"operation":"Element-wise Exponentiate","data":"Base"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Sum","data":"Exponentiation"},"control_points":[]},{"source":{"operation":"Element-wise Exponentiate","data":"Exponentiation"},"sink":{"operation":"Element-wise Divide","data":"Left Operand"},"control_points":[]},{"source":{"operation":"Sum","data":"Summed Result"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"Broadcast Summed Denominator to Shape","data":"Shape"},"control_points":[{"x":960,"y":701},{"x":2836,"y":701}]},{"source":{"operation":"Broadcast Summed Denominator to Shape","data":"Result"},"sink":{"operation":"Element-wise Divide","data":"Right Operand"},"control_points":[]},{"source":{"operation":"Element-wise Divide","data":"Result"},"sink":{"operation":"this","data":"arg 0"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"Sum","data":"Dim Index"},"control_points":[{"x":371,"y":597},{"x":2204,"y":597}]},{"source":{"operation":"Get Shape for Logits","data":"Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"Element-wise Exponentiate","data":"Exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"maximum","data":"array"},"control_points":[{"x":238,"y":227}]},{"source":{"operation":"maximum","data":"maximum_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Dim Index"},"sink":{"operation":"maximum","data":"dimension_index"},"control_points":[{"x":193,"y":262}]}]},{"name":"v proj","type":"COMPOSITE_OPERATION","position":{"x":2187,"y":437},"inputs":[{"name":"70_971","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_79_1089","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[128,256],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":43},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":379,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":195},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":782},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"BIas","type":"COMPOSITE_OPERATION","position":{"x":3333,"y":380},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":289,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/v_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"BIas","data":"shape"},"control_points":[]},{"source":{"operation":"BIas","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_79_1089"},"control_points":[]},{"source":{"operation":"this","data":"70_971"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]},{"name":"reshape_172_980","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2622,"y":437},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,4096,8,16],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"transpose_19_981","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3045,"y":437},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"arg 0","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"matmul_30_986","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":3499,"y":249},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"transpose_20_987","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":3885,"y":249},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_173_988","type":"COMPOSITE_OPERATION","position":{"x":4299,"y":249},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":196},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":818,"y":378},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":819,"y":193},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[1],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1207,"y":370},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1671,"y":190},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2145,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2505,"y":40},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2865,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"out proj","type":"COMPOSITE_OPERATION","position":{"x":4723,"y":249},"inputs":[{"name":"173_988","primitive_name":"reshape_2_9"}],"outputs":[{"name":"linear_80_1103","primitive_name":"linear_1_10","flow_state":"UNBOUND"}],"operations":[{"name":"linear_1_10","type":"COMPOSITE_OPERATION","position":{"x":200,"y":100},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Weight Shape","data":[256,128],"shape":[2],"type":"INTEGER","primitive_name":"Weight Shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Flatten","type":"COMPOSITE_OPERATION","position":{"x":889,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"N","primitive_name":"Output (1)","flow_state":"UNBOUND"},{"name":"H, W","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":636,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1142,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1504,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":668,"y":338},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":678,"y":612},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":339},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2219,"y":574},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2681,"y":163},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Product","data":"prod_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[{"x":466,"y":270}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"this","data":"N"},"control_points":[{"x":1586,"y":904},{"x":2590,"y":904}]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"H, W"},"control_points":[{"x":1837,"y":889},{"x":2662,"y":889}]}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":489,"y":196},"inputs":[{"name":"shape","shape":[2],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":329,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[2],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Reshape Weight","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":196},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"N","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":380,"y":389},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":104},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":692,"y":278},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Put At Index","type":"COMPOSITE_OPERATION","position":{"x":1034,"y":279},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Value","primitive_name":"Input (1)"},{"name":"Dimension","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"},{"name":"Index","data":0,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":411,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":919,"y":95},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":309,"y":581},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"scatter","primitive_name":"scatter","type":"PRIMITIVE_OPERATION","position":{"x":1691,"y":455},"inputs":[{"name":"source_array","primitive_name":"source_array"},{"name":"receiver_array","primitive_name":"receiver_array"},{"name":"dimension_index","shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SINK"},{"name":"selected_indices","primitive_name":"selected_indices"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Is Scalar","primitive_name":"Is Scalar","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":512,"y":359},"inputs":[{"name":"variable","primitive_name":"variable"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"scatter","data":"source_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"scatter","data":"receiver_array"},"control_points":[{"x":854,"y":559}]},{"source":{"operation":"this","data":"Index"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"scatter","data":"selected_indices"},"control_points":[]},{"source":{"operation":"this","data":"Dimension"},"sink":{"operation":"scatter","data":"dimension_index"},"control_points":[{"x":672,"y":601}]},{"source":{"operation":"scatter","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Value"},"sink":{"operation":"Is Scalar","data":"variable"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1506,"y":152},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1928,"y":150},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Put At Index","data":"Input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"Put At Index","data":"Value"},"control_points":[]},{"source":{"operation":"Put At Index","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"N"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":1868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2368,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2868,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Construct Output Shape","type":"COMPOSITE_OPERATION","position":{"x":3442,"y":779},"inputs":[{"name":"N","primitive_name":"Input"},{"name":"H, W","primitive_name":"Input"},{"name":"Channels","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":595,"y":183},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1179,"y":431},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"N"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"H, W"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Channels"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3260,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":349,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/final_attn_token_to_image/out_proj/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":3868,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":4368,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4868,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":5249,"y":365},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":2693,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Flatten","data":"Input"},"control_points":[]},{"source":{"operation":"Flatten","data":"Output"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Reshape Weight","data":"N"},"control_points":[]},{"source":{"operation":"Reshape Weight","data":"Output"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"Flatten","data":"N"},"sink":{"operation":"Construct Output Shape","data":"N"},"control_points":[{"x":1693,"y":844}]},{"source":{"operation":"Flatten","data":"H, W"},"sink":{"operation":"Construct Output Shape","data":"H, W"},"control_points":[{"x":1679,"y":886}]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Construct Output Shape","data":"Channels"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"Construct Output Shape","data":"Output"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[{"x":4647,"y":844}]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Reshape Weight","data":"Input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"linear_1_10","data":"Output"},"sink":{"operation":"this","data":"linear_80_1103"},"control_points":[]},{"source":{"operation":"this","data":"173_988"},"sink":{"operation":"linear_1_10","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"87_1086"},"sink":{"operation":"k proj","data":"70_971"},"control_points":[]},{"source":{"operation":"this","data":"86_1085"},"sink":{"operation":"q proj","data":"70_971"},"control_points":[]},{"source":{"operation":"k proj","data":"linear_78_1088"},"sink":{"operation":"reshape_171_978","data":"input"},"control_points":[]},{"source":{"operation":"reshape_171_978","data":"output"},"sink":{"operation":"transpose_18_979","data":"array"},"control_points":[]},{"source":{"operation":"transpose_18_979","data":"swapped_array"},"sink":{"operation":"permute_95_982","data":"array"},"control_points":[]},{"source":{"operation":"q proj","data":"linear_77_1087"},"sink":{"operation":"reshape_170_976","data":"input"},"control_points":[]},{"source":{"operation":"reshape_170_976","data":"output"},"sink":{"operation":"transpose_17_977","data":"array"},"control_points":[]},{"source":{"operation":"transpose_17_977","data":"arg 0"},"sink":{"operation":"matmul_29_983","data":"left_operand"},"control_points":[]},{"source":{"operation":"permute_95_982","data":"arg 1"},"sink":{"operation":"matmul_29_983","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_29_983","data":"multiplied_result"},"sink":{"operation":"truediv_8_984","data":"Input"},"control_points":[]},{"source":{"operation":"truediv_8_984","data":"Output"},"sink":{"operation":"Softmax","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"79_1089"},"sink":{"operation":"v proj","data":"70_971"},"control_points":[{"x":671,"y":502}]},{"source":{"operation":"v proj","data":"linear_79_1089"},"sink":{"operation":"reshape_172_980","data":"input"},"control_points":[]},{"source":{"operation":"reshape_172_980","data":"output"},"sink":{"operation":"transpose_19_981","data":"array"},"control_points":[]},{"source":{"operation":"Softmax","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"left_operand"},"control_points":[]},{"source":{"operation":"transpose_19_981","data":"arg 0"},"sink":{"operation":"matmul_30_986","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_30_986","data":"multiplied_result"},"sink":{"operation":"transpose_20_987","data":"array"},"control_points":[]},{"source":{"operation":"transpose_20_987","data":"swapped_array"},"sink":{"operation":"reshape_173_988","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_173_988","data":"Output"},"sink":{"operation":"out proj","data":"173_988"},"control_points":[]},{"source":{"operation":"out proj","data":"linear_80_1103"},"sink":{"operation":"this","data":"80_1103"},"control_points":[]}]},{"name":"add_88_1104","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":4476,"y":352},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"layer_norm_33_1105","type":"COMPOSITE_OPERATION","position":{"x":4943,"y":352},"inputs":[{"name":"88_1104","primitive_name":"add_1_3"}],"outputs":[{"name":"33_1105","primitive_name":"layernorm_1_4","flow_state":"UNBOUND"}],"operations":[{"name":"layernorm_1_4","type":"COMPOSITE_OPERATION","position":{"x":304,"y":96},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"eps","data":1e-06,"shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":434,"y":314},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":848,"y":166},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract_1","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1196,"y":166},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"Calculate Standard Deviation","type":"COMPOSITE_OPERATION","position":{"x":2517,"y":552},"inputs":[{"name":"Array","primitive_name":"Input"},{"name":"Dimension Index","primitive_name":"New Input"},{"name":"Keep Dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"New Input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":475,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":476,"y":446},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1075,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":1854,"y":1},"inputs":[{"name":"Scalar","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":938,"y":666},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","primitive_name":"selected_index"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"parse_decimal","primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1320,"y":666},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_2","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1730,"y":666},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":1515,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"input_order":[1,0],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2142,"y":624},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":2504,"y":328},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate_1","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":2893,"y":1},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":3301,"y":53},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SINK"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":3750,"y":11},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate_3","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":4256,"y":120},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"input_order":[1,0],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":417,"y":508}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_exponentiate_3","data":"exponent"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_3","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"reduce_one_dimension","data":"selected_index"},"control_points":[{"x":577,"y":812}]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_exponentiate_2","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":362,"y":432}]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_2","data":"exponentiation"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[{"x":1990,"y":508}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate_1","data":"exponent"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"element_wise_exponentiate_1","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate_1","data":"exponentiation"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Dimension Index"},"sink":{"operation":"sum","data":"dimension_index"},"control_points":[{"x":384,"y":258},{"x":3127,"y":258}]},{"source":{"operation":"this","data":"Keep Dimension"},"sink":{"operation":"sum","data":"keep_dimension"},"control_points":[{"x":382,"y":314},{"x":3109,"y":314}]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_exponentiate_3","data":"base"},"control_points":[{"x":3668,"y":224}]}]},{"name":"mean","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1570,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2064,"y":272},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":2535,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2922,"y":423},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape_1","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3299,"y":510},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"Add Eps To Zeros","type":"COMPOSITE_OPERATION","position":{"x":3659,"y":510},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Eps","shape":[],"type":"DECIMAL","primitive_name":"Input (1)","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":332,"y":336},"inputs":[{"name":"Target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":723,"y":186},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Broadcast Target to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":324,"y":518},"inputs":[{"name":"Target","shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SINK"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1487,"y":29},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[]},{"source":{"operation":"this","data":"Eps"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array (1)","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array (1)","data":"Output"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":4209,"y":272},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":4707,"y":680},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","primitive_name":"dimension_index"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Element-wise Linear Layer","type":"COMPOSITE_OPERATION","position":{"x":5106,"y":272},"inputs":[{"name":"Input","primitive_name":"new_inp"},{"name":"Hidden Size","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"new_out","flow_state":"UNBOUND"}],"operations":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":399,"y":642},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":750,"y":294},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":319,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layer_norm_final_attn/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise","type":"COMPOSITE_OPERATION","position":{"x":1164,"y":255},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":799,"y":202},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":447},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1814,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1679,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":603,"y":512}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1811,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":1834,"y":642},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":347,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/transformer/layer_norm_final_attn/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast for Element Wise (1)","type":"COMPOSITE_OPERATION","position":{"x":2676,"y":416},"inputs":[{"name":"Array with Target Shape","primitive_name":"Input"},{"name":"Array to Broadcast","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":481,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":851,"y":151},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1216,"y":413},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1856,"y":263},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Array with Target Shape"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1724,"y":105}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"this","data":"Array to Broadcast"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[{"x":650,"y":475}]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3286,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast for Element Wise","data":"Array with Target Shape"},"control_points":[{"x":974,"y":105}]},{"source":{"operation":"Broadcast for Element Wise","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array with Target Shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast for Element Wise (1)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Broadcast for Element Wise","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Broadcast for Element Wise (1)","data":"Array to Broadcast"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":320,"y":376}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Standard Deviation","data":"Array"},"control_points":[{"x":480,"y":614}]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"Calculate Standard Deviation","data":"Output"},"sink":{"operation":"broadcast_to_shape_1","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[{"x":482,"y":614},{"x":2337,"y":614}]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"Element-wise Linear Layer","data":"Input"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"Element-wise Linear Layer","data":"Hidden Size"},"control_points":[]},{"source":{"operation":"Element-wise Linear Layer","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"subtract_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"mean","data":"dimension_index"},"control_points":[]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"Calculate Standard Deviation","data":"Dimension Index"},"control_points":[{"x":2020,"y":656}]},{"source":{"operation":"subtract_1","data":"subtracted_result"},"sink":{"operation":"get_dimension_size","data":"dimension_index"},"control_points":[{"x":2182,"y":784}]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"Add Eps To Zeros","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"eps"},"sink":{"operation":"Add Eps To Zeros","data":"Eps"},"control_points":[{"x":569,"y":826},{"x":3435,"y":826}]},{"source":{"operation":"Add Eps To Zeros","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]}]}],"links":[{"source":{"operation":"layernorm_1_4","data":"Output"},"sink":{"operation":"this","data":"33_1105"},"control_points":[]},{"source":{"operation":"this","data":"88_1104"},"sink":{"operation":"layernorm_1_4","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"layers_0","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"unsqueeze_3_952"},"sink":{"operation":"layers_0","data":"3_952"},"control_points":[]},{"source":{"operation":"this","data":"unsqueeze_2_949"},"sink":{"operation":"layers_0","data":"2_949"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"add_77_1018","data":"right_operand"},"control_points":[]},{"source":{"operation":"layers_0","data":"layernorm_27_996"},"sink":{"operation":"add_77_1018","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_77_1018","data":"added_result"},"sink":{"operation":"layers_1","data":"77_1018"},"control_points":[]},{"source":{"operation":"this","data":"unsqueeze_3_952"},"sink":{"operation":"layers_1","data":"3_952"},"control_points":[]},{"source":{"operation":"layers_0","data":"layernorm_27_996"},"sink":{"operation":"layers_1","data":"27_996"},"control_points":[]},{"source":{"operation":"layers_0","data":"28_1017"},"sink":{"operation":"layers_1","data":"28_1017"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"layers_1","data":"17_943"},"control_points":[]},{"source":{"operation":"layers_1","data":"32_1084"},"sink":{"operation":"add_87_1086","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"unsqueeze_3_952"},"sink":{"operation":"add_87_1086","data":"left_operand"},"control_points":[{"x":1256,"y":158}]},{"source":{"operation":"layers_1","data":"31_1063"},"sink":{"operation":"add_86_1085","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"to_17_943"},"sink":{"operation":"add_86_1085","data":"left_operand"},"control_points":[{"x":1144,"y":924}]},{"source":{"operation":"add_86_1085","data":"added_result"},"sink":{"operation":"layer 3: final_token_to_image","data":"86_1085"},"control_points":[]},{"source":{"operation":"add_87_1086","data":"added_result"},"sink":{"operation":"layer 3: final_token_to_image","data":"87_1086"},"control_points":[]},{"source":{"operation":"layers_1","data":"32_1084"},"sink":{"operation":"layer 3: final_token_to_image","data":"79_1089"},"control_points":[]},{"source":{"operation":"layers_1","data":"31_1063"},"sink":{"operation":"add_88_1104","data":"right_operand"},"control_points":[]},{"source":{"operation":"layer 3: final_token_to_image","data":"80_1103"},"sink":{"operation":"add_88_1104","data":"left_operand"},"control_points":[]},{"source":{"operation":"add_88_1104","data":"added_result"},"sink":{"operation":"layer_norm_33_1105","data":"88_1104"},"control_points":[]},{"source":{"operation":"layer_norm_33_1105","data":"33_1105"},"sink":{"operation":"this","data":"33_1105"},"control_points":[]},{"source":{"operation":"layers_1","data":"32_1084"},"sink":{"operation":"this","data":"32_1084"},"control_points":[{"x":3832,"y":157}]}]},{"name":"Mask Decoder Upscale Layer Norm","type":"COMPOSITE_OPERATION","position":{"x":1320,"y":252},"inputs":[{"name":"image embeddings","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"transpose_41_1108","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":373,"y":190},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"reshape_194_1109","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":810,"y":190},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,256,64,64],"shape":[4],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"convtranspose2d_1","type":"COMPOSITE_OPERATION","position":{"x":1314,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"weight shape","data":[256,64,2,2],"shape":[4],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Weights and Bias","type":"COMPOSITE_OPERATION","position":{"x":326,"y":309},"inputs":[{"name":"Input","shape":[4],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"Bias","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"Read Weight From File with shape check","type":"COMPOSITE_OPERATION","position":{"x":410,"y":41},"inputs":[{"name":"Weight Shape","shape":[4],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":424,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_conv1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":886,"y":320},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1378,"y":446},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[4],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1002,"y":42},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":628,"y":553}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":343},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":1500,"y":343},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[0],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"Read Bias From File with shape check","type":"COMPOSITE_OPERATION","position":{"x":1902,"y":343},"inputs":[{"name":"Weight Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":382,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_conv1/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":886,"y":320},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1378,"y":446},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":537,"y":553}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Read Weight From File with shape check","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Read Weight From File with shape check","data":"Output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"Read Bias From File with shape check","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Read Bias From File with shape check","data":"Output"},"sink":{"operation":"this","data":"Bias"},"control_points":[]},{"source":{"operation":"Read Weight From File with shape check","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Prepare Stride","type":"COMPOSITE_OPERATION","position":{"x":966,"y":309},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":306,"y":103},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":690,"y":103},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conv2d_transpose","primitive_name":"conv2d_transpose","type":"PRIMITIVE_OPERATION","position":{"x":1550,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"kernel","primitive_name":"kernel"},{"name":"stride","primitive_name":"stride"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Expand 4 Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1389,"y":477},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","data":4,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":85},"inputs":[{"name":"left_operand","shape":[],"type":"INTEGER","primitive_name":"left_operand","flow_state":"BOOT_SINK"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":85},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2121,"y":148},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":2039,"y":477},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2101,"y":240},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2570,"y":477},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3155,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Weights and Bias","data":"Output"},"sink":{"operation":"Prepare Stride","data":"Input"},"control_points":[]},{"source":{"operation":"Weights and Bias","data":"Output"},"sink":{"operation":"conv2d_transpose","data":"kernel"},"control_points":[]},{"source":{"operation":"Prepare Stride","data":"Output"},"sink":{"operation":"conv2d_transpose","data":"stride"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conv2d_transpose","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"weight shape"},"sink":{"operation":"Weights and Bias","data":"Input"},"control_points":[]},{"source":{"operation":"Expand 4 Dimensions","data":"Output"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"Weights and Bias","data":"Bias"},"sink":{"operation":"Expand 4 Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"conv2d_transpose","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"conv2d_transpose","data":"output"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"LayerNorm","type":"COMPOSITE_OPERATION","position":{"x":1762,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"mean_5_1112","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":326,"y":314},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"sub_33_1113","type":"COMPOSITE_OPERATION","position":{"x":951,"y":44},"inputs":[{"name":"arg0","primitive_name":"Input"},{"name":"arg1","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":419,"y":215},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":928,"y":40},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"arg1"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"sub_34_1116","type":"COMPOSITE_OPERATION","position":{"x":958,"y":269},"inputs":[{"name":"arg0","primitive_name":"Input"},{"name":"arg1","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":419,"y":215},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":928,"y":40},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"arg1"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"pow_3_1114","type":"COMPOSITE_OPERATION","position":{"x":1412,"y":42},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":303,"y":217},"inputs":[{"name":"Target","data":2.0,"shape":[],"type":"DECIMAL","primitive_name":"Target","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":877,"y":43},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_exponentiate","data":"exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"mean_6_115","primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":1902,"y":39},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND"}]},{"name":"sqrt_3_1118","type":"COMPOSITE_OPERATION","position":{"x":2337,"y":37},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":365,"y":210},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":895,"y":172},"inputs":[{"name":"target","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":1497,"y":134},"inputs":[{"name":"base","primitive_name":"base"},{"name":"exponent","primitive_name":"exponent"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"element_wise_exponentiate","data":"exponent"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_exponentiate","data":"base"},"control_points":[{"x":1410,"y":99}]}]},{"name":"truediv_14_1119","type":"COMPOSITE_OPERATION","position":{"x":2802,"y":225},"inputs":[{"name":"arg0","primitive_name":"Input"},{"name":"arg1","primitive_name":"Input (1)"}],"input_order":[1,0],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":434,"y":183},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"divide","primitive_name":"divide","type":"PRIMITIVE_OPERATION","position":{"x":970,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"divided_result","primitive_name":"divided_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"divide","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"divide","data":"right_operand"},"control_points":[]},{"source":{"operation":"divide","data":"divided_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"arg1"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"arg0"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1490,"y":464},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":2001,"y":460},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":2804,"y":463},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":299,"y":37},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_layer_norm/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":907,"y":38},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":36},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_2","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1793,"y":34},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"expand_one_dimension_2","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_2","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"mul_63_1122","type":"COMPOSITE_OPERATION","position":{"x":3366,"y":221},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":344,"y":194},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":831,"y":44},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":3366,"y":450},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":280,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_layer_norm/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":907,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_1","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension_2","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1793,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"expand_one_dimension_1","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_1","data":"output"},"sink":{"operation":"expand_one_dimension_2","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension_2","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"add_90_1124","type":"COMPOSITE_OPERATION","position":{"x":3897,"y":220},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Target to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":348,"y":171},"inputs":[{"name":"Target","primitive_name":"Target"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Target"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":918,"y":40},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"Broadcast Target to Shape of Array","data":"Target"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Target to Shape of Array","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"mean_5_1112","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"sub_33_1113","data":"arg0"},"control_points":[]},{"source":{"operation":"mean_5_1112","data":"mean_result"},"sink":{"operation":"sub_33_1113","data":"arg1"},"control_points":[]},{"source":{"operation":"mean_5_1112","data":"mean_result"},"sink":{"operation":"sub_34_1116","data":"arg1"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"sub_34_1116","data":"arg0"},"control_points":[]},{"source":{"operation":"sub_33_1113","data":"Output"},"sink":{"operation":"pow_3_1114","data":"Input"},"control_points":[]},{"source":{"operation":"pow_3_1114","data":"Output"},"sink":{"operation":"mean_6_115","data":"array"},"control_points":[]},{"source":{"operation":"mean_6_115","data":"mean_result"},"sink":{"operation":"sqrt_3_1118","data":"Input"},"control_points":[]},{"source":{"operation":"sub_34_1116","data":"Output"},"sink":{"operation":"truediv_14_1119","data":"arg0"},"control_points":[]},{"source":{"operation":"sqrt_3_1118","data":"Output"},"sink":{"operation":"truediv_14_1119","data":"arg1"},"control_points":[]},{"source":{"operation":"sub_34_1116","data":"Output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"truediv_14_1119","data":"Output"},"sink":{"operation":"mul_63_1122","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"mul_63_1122","data":"Input (1)"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[{"x":2464,"y":646},{"x":3198,"y":646}]},{"source":{"operation":"mul_63_1122","data":"Output"},"sink":{"operation":"add_90_1124","data":"Input"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"add_90_1124","data":"Input (1)"},"control_points":[]},{"source":{"operation":"add_90_1124","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"GELU","type":"COMPOSITE_OPERATION","position":{"x":2240,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":557,"y":158},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Scalar","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1268,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":498,"y":514},"inputs":[{"name":"base","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"base","flow_state":"BOOT_SOURCE"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":933,"y":514},"inputs":[{"name":"Scalar","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply_1","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1562,"y":339},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"error_function","primitive_name":"error_function","type":"PRIMITIVE_OPERATION","position":{"x":2100,"y":339},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (2)","type":"COMPOSITE_OPERATION","position":{"x":2656,"y":502},"inputs":[{"name":"Scalar","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3239,"y":339},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"element_wise_multiply_2","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":3782,"y":43},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Scalar"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_multiply_1","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"element_wise_multiply_2","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply_1","data":"left_array"},"control_points":[{"x":262,"y":401}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[{"x":387,"y":695},{"x":855,"y":695}]},{"source":{"operation":"element_wise_multiply_1","data":"multiplied_array"},"sink":{"operation":"error_function","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (2)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"element_wise_multiply_2","data":"right_array"},"control_points":[]},{"source":{"operation":"error_function","data":"output"},"sink":{"operation":"Broadcast Scalar to Shape of Array (2)","data":"Array"},"control_points":[]},{"source":{"operation":"error_function","data":"output"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"element_wise_multiply_2","data":"multiplied_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"convtranspose2d_2","type":"COMPOSITE_OPERATION","position":{"x":2652,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"weight shape","data":[64,32,2,2],"shape":[4],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Weights and Bias","type":"COMPOSITE_OPERATION","position":{"x":326,"y":309},"inputs":[{"name":"Input","shape":[4],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"},{"name":"Bias","primitive_name":"Output (1)","flow_state":"UNBOUND"}],"operations":[{"name":"Read Weight From File with shape check","type":"COMPOSITE_OPERATION","position":{"x":410,"y":41},"inputs":[{"name":"Weight Shape","shape":[4],"type":"INTEGER","primitive_name":"Input","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":393,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_conv2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":1002,"y":40},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":886,"y":320},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1378,"y":446},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","shape":[4],"type":"INTEGER","primitive_name":"variable_1","flow_state":"BOOT_SINK"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":628,"y":553}]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":343},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":1500,"y":343},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[0],"shape":[1],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"Read Bias From File with shape check","type":"COMPOSITE_OPERATION","position":{"x":1902,"y":343},"inputs":[{"name":"Weight Shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":428,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/upscale_conv2/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":886,"y":320},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1378,"y":446},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"Weight Shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":537,"y":553}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Read Weight From File with shape check","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Read Weight From File with shape check","data":"Output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"Read Bias From File with shape check","data":"Weight Shape"},"control_points":[]},{"source":{"operation":"Read Bias From File with shape check","data":"Output"},"sink":{"operation":"this","data":"Bias"},"control_points":[]},{"source":{"operation":"Read Weight From File with shape check","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Prepare Stride","type":"COMPOSITE_OPERATION","position":{"x":966,"y":309},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":306,"y":103},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":690,"y":103},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"conv2d_transpose","primitive_name":"conv2d_transpose","type":"PRIMITIVE_OPERATION","position":{"x":1550,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"kernel","primitive_name":"kernel"},{"name":"stride","primitive_name":"stride"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Expand 4 Dimensions","type":"COMPOSITE_OPERATION","position":{"x":1389,"y":477},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","data":4,"shape":[],"type":"INTEGER","primitive_name":"Input (1)","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":85},"inputs":[{"name":"left_operand","shape":[],"type":"INTEGER","primitive_name":"left_operand","flow_state":"BOOT_SINK"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":85},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2121,"y":148},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]},{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":2039,"y":477},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":3,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2101,"y":240},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2570,"y":477},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3155,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Weights and Bias","data":"Output"},"sink":{"operation":"Prepare Stride","data":"Input"},"control_points":[]},{"source":{"operation":"Weights and Bias","data":"Output"},"sink":{"operation":"conv2d_transpose","data":"kernel"},"control_points":[]},{"source":{"operation":"Prepare Stride","data":"Output"},"sink":{"operation":"conv2d_transpose","data":"stride"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conv2d_transpose","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"weight shape"},"sink":{"operation":"Weights and Bias","data":"Input"},"control_points":[]},{"source":{"operation":"Expand 4 Dimensions","data":"Output"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"Weights and Bias","data":"Bias"},"sink":{"operation":"Expand 4 Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"conv2d_transpose","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"conv2d_transpose","data":"output"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"GELU_14_1127","type":"COMPOSITE_OPERATION","position":{"x":3077,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Broadcast Scalar to Shape of Array","type":"COMPOSITE_OPERATION","position":{"x":557,"y":158},"inputs":[{"name":"Scalar","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"Scalar","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1268,"y":41},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"element_wise_exponentiate","primitive_name":"element_wise_exponentiate","type":"PRIMITIVE_OPERATION","position":{"x":498,"y":514},"inputs":[{"name":"base","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"base","flow_state":"BOOT_SOURCE"},{"name":"exponent","data":0.5,"shape":[],"type":"DECIMAL","primitive_name":"exponent","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"exponentiation","primitive_name":"exponentiation","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (1)","type":"COMPOSITE_OPERATION","position":{"x":933,"y":514},"inputs":[{"name":"Scalar","primitive_name":"Input"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"element_wise_multiply_1","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":1562,"y":336},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]},{"name":"error_function","primitive_name":"error_function","type":"PRIMITIVE_OPERATION","position":{"x":2100,"y":336},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Broadcast Scalar to Shape of Array (2)","type":"COMPOSITE_OPERATION","position":{"x":2656,"y":502},"inputs":[{"name":"Scalar","data":1.0,"shape":[],"type":"DECIMAL","primitive_name":"Input","flow_state":"BOOT_SOURCE"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":601,"y":346},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1097,"y":42},"inputs":[{"name":"target","shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SINK"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[{"x":427,"y":404}]},{"source":{"operation":"this","data":"Scalar"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":3239,"y":336},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]},{"name":"element_wise_multiply_2","primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":3782,"y":41},"inputs":[{"name":"left_array","primitive_name":"left_array"},{"name":"right_array","primitive_name":"right_array"}],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Scalar to Shape of Array","data":"Array"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array","data":"Output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_exponentiate","data":"exponentiation"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Scalar"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Output"},"sink":{"operation":"element_wise_multiply_1","data":"right_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"element_wise_multiply_2","data":"left_array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"element_wise_multiply_1","data":"left_array"},"control_points":[{"x":262,"y":401}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Broadcast Scalar to Shape of Array (1)","data":"Array"},"control_points":[{"x":387,"y":695},{"x":855,"y":695}]},{"source":{"operation":"element_wise_multiply_1","data":"multiplied_array"},"sink":{"operation":"error_function","data":"input"},"control_points":[]},{"source":{"operation":"Broadcast Scalar to Shape of Array (2)","data":"Output"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"element_wise_multiply_2","data":"right_array"},"control_points":[]},{"source":{"operation":"error_function","data":"output"},"sink":{"operation":"Broadcast Scalar to Shape of Array (2)","data":"Array"},"control_points":[]},{"source":{"operation":"error_function","data":"output"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"element_wise_multiply_2","data":"multiplied_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"reshape_195_1153","type":"COMPOSITE_OPERATION","position":{"x":3508,"y":190},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":333,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"gather","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":729,"y":379},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[2,3],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"product","primitive_name":"product","type":"PRIMITIVE_OPERATION","position":{"x":1190,"y":375},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":true,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"prod_result","primitive_name":"prod_result","flow_state":"UNBOUND"}]},{"name":"gather_1","primitive_name":"gather","type":"PRIMITIVE_OPERATION","position":{"x":748,"y":178},"inputs":[{"name":"input","primitive_name":"input"},{"name":"index_array","data":[0,1],"shape":[2],"type":"INTEGER","primitive_name":"index_array","flow_state":"BOOT_SOURCE"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"gather_array","primitive_name":"gather_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1590,"y":175},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":1963,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2343,"y":43},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather","data":"input"},"control_points":[]},{"source":{"operation":"gather","data":"gather_array"},"sink":{"operation":"product","data":"array"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"gather_1","data":"input"},"control_points":[]},{"source":{"operation":"gather_1","data":"gather_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"product","data":"prod_result"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"image embeddings"},"sink":{"operation":"transpose_41_1108","data":"array"},"control_points":[]},{"source":{"operation":"transpose_41_1108","data":"swapped_array"},"sink":{"operation":"reshape_194_1109","data":"input"},"control_points":[]},{"source":{"operation":"GELU_14_1127","data":"Output"},"sink":{"operation":"reshape_195_1153","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_195_1153","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"LayerNorm","data":"Output"},"sink":{"operation":"GELU","data":"Input"},"control_points":[]},{"source":{"operation":"reshape_194_1109","data":"output"},"sink":{"operation":"convtranspose2d_1","data":"Input"},"control_points":[]},{"source":{"operation":"convtranspose2d_1","data":"Output"},"sink":{"operation":"LayerNorm","data":"Input"},"control_points":[]},{"source":{"operation":"GELU","data":"Output"},"sink":{"operation":"convtranspose2d_2","data":"Input"},"control_points":[]},{"source":{"operation":"convtranspose2d_2","data":"Output"},"sink":{"operation":"GELU_14_1127","data":"Input"},"control_points":[]}]},{"name":"Mask Decoder Output Hypernetworks MLPs","type":"COMPOSITE_OPERATION","position":{"x":1318,"y":128},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"2_1152","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"getitem_118_1107","primitive_name":"get_sub_arrays","type":"PRIMITIVE_OPERATION","position":{"x":270,"y":347},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_indices","data":[1,2,3,4],"shape":[4],"type":"INTEGER","primitive_name":"selected_indices","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"getitem_121_1128","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":789,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"getitem_122_1134  ","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":788,"y":221},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":" getitem_123_1140","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":787,"y":400},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":" getitem_124_1146","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":782,"y":574},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"mlp 0","type":"COMPOSITE_OPERATION","position":{"x":1256,"y":47},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Linear Layer (proj_in)","type":"COMPOSITE_OPERATION","position":{"x":423,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1326,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":369,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/0/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":750,"y":248},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1714,"y":215},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2106,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4278,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/0/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU","type":"COMPOSITE_OPERATION","position":{"x":996,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (layer_0)","type":"COMPOSITE_OPERATION","position":{"x":1514,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1342,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":359,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/0/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1723,"y":216},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2087,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":343,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/0/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU (1)","type":"COMPOSITE_OPERATION","position":{"x":1998,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (proj_out)","type":"COMPOSITE_OPERATION","position":{"x":2470,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":32,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":514},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1394,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":265,"y":53},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/0/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":610,"y":54},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1946,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4273,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Linear Layer (proj_in)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_in)","data":"Output"},"sink":{"operation":"ReLU","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU","data":"Output"},"sink":{"operation":"Linear Layer (layer_0)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (layer_0)","data":"Output"},"sink":{"operation":"ReLU (1)","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU (1)","data":"Output"},"sink":{"operation":"Linear Layer (proj_out)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_out)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"documentations":[]},{"name":"mlp 1","type":"COMPOSITE_OPERATION","position":{"x":1258,"y":221},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Linear Layer (proj_in)","type":"COMPOSITE_OPERATION","position":{"x":423,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1336,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":334,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":750,"y":248},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1708,"y":216},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2091,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4278,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":350,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU","type":"COMPOSITE_OPERATION","position":{"x":996,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (layer_0)","type":"COMPOSITE_OPERATION","position":{"x":1514,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1332,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":42},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1717,"y":214},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2104,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":351,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU (1)","type":"COMPOSITE_OPERATION","position":{"x":1998,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (proj_out)","type":"COMPOSITE_OPERATION","position":{"x":2470,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":32,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":514},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1394,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":254,"y":51},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":610,"y":54},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1946,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4273,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":531,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/1/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Linear Layer (proj_in)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_in)","data":"Output"},"sink":{"operation":"ReLU","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU","data":"Output"},"sink":{"operation":"Linear Layer (layer_0)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (layer_0)","data":"Output"},"sink":{"operation":"ReLU (1)","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU (1)","data":"Output"},"sink":{"operation":"Linear Layer (proj_out)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_out)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"documentations":[]},{"name":"mlp 2","type":"COMPOSITE_OPERATION","position":{"x":1262,"y":400},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Linear Layer (proj_in)","type":"COMPOSITE_OPERATION","position":{"x":423,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1358,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":343,"y":43},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":750,"y":248},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1716,"y":216},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2095,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4278,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU","type":"COMPOSITE_OPERATION","position":{"x":996,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (layer_0)","type":"COMPOSITE_OPERATION","position":{"x":1514,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1345,"y":217},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":339,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1719,"y":219},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2115,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":340,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU (1)","type":"COMPOSITE_OPERATION","position":{"x":1998,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (proj_out)","type":"COMPOSITE_OPERATION","position":{"x":2470,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":32,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":514},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1394,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":246,"y":53},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":610,"y":54},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1946,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4273,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":530,"y":39},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/2/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Linear Layer (proj_in)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_in)","data":"Output"},"sink":{"operation":"ReLU","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU","data":"Output"},"sink":{"operation":"Linear Layer (layer_0)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (layer_0)","data":"Output"},"sink":{"operation":"ReLU (1)","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU (1)","data":"Output"},"sink":{"operation":"Linear Layer (proj_out)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_out)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"documentations":[]},{"name":"mlp 3","type":"COMPOSITE_OPERATION","position":{"x":1264,"y":574},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Linear Layer (proj_in)","type":"COMPOSITE_OPERATION","position":{"x":423,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1355,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":350,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":750,"y":248},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1715,"y":217},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2084,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4278,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":302,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU","type":"COMPOSITE_OPERATION","position":{"x":996,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (layer_0)","type":"COMPOSITE_OPERATION","position":{"x":1514,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1342,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":335,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1709,"y":215},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2074,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":336,"y":42},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU (1)","type":"COMPOSITE_OPERATION","position":{"x":1998,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (proj_out)","type":"COMPOSITE_OPERATION","position":{"x":2470,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":32,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":514},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1394,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":246,"y":50},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":610,"y":54},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1946,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4273,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":578,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/output_hypernetworks_mlps/3/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":584},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":43},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Linear Layer (proj_in)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_in)","data":"Output"},"sink":{"operation":"ReLU","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU","data":"Output"},"sink":{"operation":"Linear Layer (layer_0)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (layer_0)","data":"Output"},"sink":{"operation":"ReLU (1)","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU (1)","data":"Output"},"sink":{"operation":"Linear Layer (proj_out)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_out)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"documentations":[]},{"name":"stack_2_1152","type":"COMPOSITE_OPERATION","position":{"x":1834,"y":243},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"},{"name":"Input (2)","primitive_name":"Input (2)"},{"name":"03","primitive_name":"Input (3)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":392,"y":40},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":394,"y":225},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_2","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":902,"y":116},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1378,"y":114},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"03"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[]},{"source":{"operation":"this","data":"Input (2)"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_2","data":"array_1"},"control_points":[]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"concatenate_2","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate_2","data":"concatenated_array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"getitem_118_1107","data":"input"},"control_points":[]},{"source":{"operation":"getitem_118_1107","data":"output"},"sink":{"operation":"getitem_121_1128","data":"input"},"control_points":[]},{"source":{"operation":"getitem_118_1107","data":"output"},"sink":{"operation":"getitem_122_1134  ","data":"input"},"control_points":[]},{"source":{"operation":"getitem_118_1107","data":"output"},"sink":{"operation":" getitem_123_1140","data":"input"},"control_points":[]},{"source":{"operation":"getitem_118_1107","data":"output"},"sink":{"operation":" getitem_124_1146","data":"input"},"control_points":[]},{"source":{"operation":"stack_2_1152","data":"Output"},"sink":{"operation":"this","data":"2_1152"},"control_points":[]},{"source":{"operation":"getitem_121_1128","data":"output"},"sink":{"operation":"mlp 0","data":"Input"},"control_points":[]},{"source":{"operation":"getitem_122_1134  ","data":"output"},"sink":{"operation":"mlp 1","data":"Input"},"control_points":[]},{"source":{"operation":" getitem_123_1140","data":"output"},"sink":{"operation":"mlp 2","data":"Input"},"control_points":[]},{"source":{"operation":" getitem_124_1146","data":"output"},"sink":{"operation":"mlp 3","data":"Input"},"control_points":[]},{"source":{"operation":"mlp 0","data":"Output"},"sink":{"operation":"stack_2_1152","data":"Input"},"control_points":[]},{"source":{"operation":"mlp 1","data":"Output"},"sink":{"operation":"stack_2_1152","data":"Input (1)"},"control_points":[]},{"source":{"operation":"mlp 2","data":"Output"},"sink":{"operation":"stack_2_1152","data":"Input (2)"},"control_points":[]},{"source":{"operation":"mlp 3","data":"Output"},"sink":{"operation":"stack_2_1152","data":"03"},"control_points":[]}]},{"name":"Cat hypernetworks and upscale","type":"COMPOSITE_OPERATION","position":{"x":1800,"y":210},"inputs":[{"name":"arg 0","primitive_name":"Input"},{"name":"arg1","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"matmul_41_1154","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":297,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":741,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","data":[1,1,4,256,256],"shape":[5],"type":"INTEGER","primitive_name":"new_shape","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"getitem_125_1161","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1163,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"arg 0"},"sink":{"operation":"matmul_41_1154","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"arg1"},"sink":{"operation":"matmul_41_1154","data":"right_operand"},"control_points":[]},{"source":{"operation":"matmul_41_1154","data":"multiplied_result"},"sink":{"operation":"reshape","data":"input"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"getitem_125_1161","data":"array"},"control_points":[]},{"source":{"operation":"getitem_125_1161","data":"sliced_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Mask Decoder IOU prediction head","type":"COMPOSITE_OPERATION","position":{"x":1315,"y":22},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"iou_scores","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"getitem_117_1106","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":279,"y":41},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"mlp","type":"COMPOSITE_OPERATION","position":{"x":706,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Linear Layer (proj_in) ","type":"COMPOSITE_OPERATION","position":{"x":472,"y":40},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1420,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":344,"y":54},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1804,"y":216},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2202,"y":217},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2581,"y":217},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":342,"y":65},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/proj_in/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":437},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU","type":"COMPOSITE_OPERATION","position":{"x":996,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (layer_0)","type":"COMPOSITE_OPERATION","position":{"x":1514,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":256,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":974,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1299,"y":216},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":343,"y":44},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":1672,"y":214},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2062,"y":216},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4300,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":320,"y":41},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/layers/0/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":760,"y":290},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1190,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":416,"y":544}]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]},{"name":"ReLU (1)","type":"COMPOSITE_OPERATION","position":{"x":1998,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":376,"y":434},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":796,"y":393},"inputs":[{"name":"target","data":0.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1198,"y":229},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"conditional_filter","primitive_name":"conditional_filter","type":"PRIMITIVE_OPERATION","position":{"x":1967,"y":41},"inputs":[{"name":"condition","primitive_name":"condition"},{"name":"data_if_true","primitive_name":"data_if_true"},{"name":"data_if_false","primitive_name":"data_if_false"}],"input_order":[1,2,0],"outputs":[{"name":"output_data","primitive_name":"output_data","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"greater_than","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"conditional_filter","data":"condition"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"conditional_filter","data":"data_if_true"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"conditional_filter","data":"data_if_false"},"control_points":[{"x":1707,"y":447}]},{"source":{"operation":"conditional_filter","data":"output_data"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Linear Layer (proj_out)","type":"COMPOSITE_OPERATION","position":{"x":2470,"y":41},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","data":4,"shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"Calculate Multiply Weight Shape","type":"COMPOSITE_OPERATION","position":{"x":500,"y":511},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Hidden Size","shape":[],"type":"INTEGER","primitive_name":"Hidden Size","flow_state":"BOOT_SINK"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":580,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_2","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1158,"y":348},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":718,"y":688},"inputs":[{"name":"input","shape":[],"type":"INTEGER","primitive_name":"input","flow_state":"BOOT_SINK"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1159,"y":43},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":1617,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"concatenate_1","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2085,"y":306},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice_2","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"slice_2","data":"sliced_array"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"concatenate_1","data":"array_1"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"concatenate_1","data":"array_2"},"control_points":[{"x":1937,"y":750}]},{"source":{"operation":"concatenate_1","data":"concatenated_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1000,"y":216},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Weights","type":"COMPOSITE_OPERATION","position":{"x":1545,"y":215},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file_1","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":277,"y":54},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"weight","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Transpose 1D and 2D","type":"COMPOSITE_OPERATION","position":{"x":610,"y":51},"inputs":[{"name":"Array","primitive_name":"Array"}],"outputs":[{"name":"Transposed Array","primitive_name":"Transposed Array","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":416,"y":195},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":874,"y":196},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"greater_than","primitive_name":"greater_than","type":"PRIMITIVE_OPERATION","position":{"x":1356,"y":196},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","data":1,"shape":[],"type":"INTEGER","primitive_name":"right_operand","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"is_greater_than","primitive_name":"is_greater_than","flow_state":"UNBOUND"}]},{"name":"Transpose","type":"CONDITIONAL_OPERATION","position":{"x":1878,"y":196},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Array","primitive_name":"New Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"swap_dimensions","primitive_name":"swap_dimensions","type":"PRIMITIVE_OPERATION","position":{"x":592,"y":47},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index_1","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_1","flow_state":"BOOT_SOURCE"},{"name":"dimension_index_2","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index_2","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"swapped_array","primitive_name":"swapped_array","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"swap_dimensions","data":"array"},"control_points":[]},{"source":{"operation":"swap_dimensions","data":"swapped_array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":534,"y":47},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"Transpose","data":"Output"},"sink":{"operation":"this","data":"Transposed Array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"greater_than","data":"left_operand"},"control_points":[]},{"source":{"operation":"greater_than","data":"is_greater_than"},"sink":{"operation":"Transpose","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Array"},"sink":{"operation":"Transpose","data":"Array"},"control_points":[{"x":344,"y":432},{"x":1756,"y":432}]}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file_1","data":"output"},"sink":{"operation":"Transpose 1D and 2D","data":"Array"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"Transpose 1D and 2D","data":"Transposed Array"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":2102,"y":215},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":2446,"y":216},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"multiply","primitive_name":"multiply","type":"PRIMITIVE_OPERATION","position":{"x":2946,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"multiplied_result","primitive_name":"multiplied_result","flow_state":"UNBOUND"}]},{"name":"Get Shape for Multiplied Result","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3446,"y":234},"inputs":[{"name":"Input","primitive_name":"input"}],"outputs":[{"name":"Shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"slice_1","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":3891,"y":383},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":3,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]},{"name":"Bias","type":"COMPOSITE_OPERATION","position":{"x":4273,"y":383},"inputs":[{"name":"shape","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"read_from_file","primitive_name":"read_from_file","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":40},"inputs":[{"name":"dir_path","data":"${Pretrain Directory (Read Only)}/mask_decoder/iou_prediction_head/proj_out/","shape":[],"type":"TEXT","primitive_name":"dir_path","flow_state":"BOOT_SOURCE"},{"name":"file_name","data":"bias","shape":[],"type":"TEXT","primitive_name":"file_name","flow_state":"BOOT_SOURCE"},{"name":"extraction_schema","data":"{}","shape":[],"type":"TEXT","primitive_name":"extraction_schema","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":1090,"y":295},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"Shape Is The Same As","primitive_name":"Shape Is The Same As","type":"CLIENT_SIDE_CONSTRAINT_OPERATION","position":{"x":1576,"y":440},"inputs":[{"name":"variable_0","primitive_name":"variable_0"},{"name":"variable_1","primitive_name":"variable_1"}],"outputs":[]}],"links":[{"source":{"operation":"this","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_1"},"control_points":[{"x":426,"y":544}]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"Shape Is The Same As","data":"variable_0"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"read_from_file","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Expand To Goal Shape","type":"COMPOSITE_OPERATION","position":{"x":4764,"y":581},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":446,"y":323},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1111,"y":323},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"get_dimension_size_1","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1266,"y":672},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1774,"y":323},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"Expand If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":2190,"y":1},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Num Dims","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":958,"y":112},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"Expand N Dimensions","type":"COMPOSITE_OPERATION","position":{"x":369,"y":36},"inputs":[{"name":"Input","primitive_name":"Input"},{"name":"Dims to Add","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":274,"y":191},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":657,"y":127},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"subtract","primitive_name":"subtract","type":"PRIMITIVE_OPERATION","position":{"x":982,"y":51},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"subtracted_result","primitive_name":"subtracted_result","flow_state":"UNBOUND"}]},{"name":"expand_one_dimension","primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1363,"y":78},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"Ones","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":1745,"y":84},"inputs":[{"name":"target","data":1,"shape":[],"type":"INTEGER","primitive_name":"target","flow_state":"BOOT_SOURCE"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"concatenate","primitive_name":"concatenate","type":"PRIMITIVE_OPERATION","position":{"x":2127,"y":83},"inputs":[{"name":"array_1","primitive_name":"array_1"},{"name":"array_2","primitive_name":"array_2"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"concatenated_array","primitive_name":"concatenated_array","flow_state":"UNBOUND"}]},{"name":"reshape","primitive_name":"reshape","type":"PRIMITIVE_OPERATION","position":{"x":2453,"y":1},"inputs":[{"name":"input","primitive_name":"input"},{"name":"new_shape","primitive_name":"new_shape"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"Ones","data":"shape"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"subtract","data":"right_operand"},"control_points":[]},{"source":{"operation":"subtract","data":"subtracted_result"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"Ones","data":"result"},"sink":{"operation":"concatenate","data":"array_1"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"concatenate","data":"array_2"},"control_points":[]},{"source":{"operation":"concatenate","data":"concatenated_array"},"sink":{"operation":"reshape","data":"new_shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Dims to Add"},"sink":{"operation":"subtract","data":"left_operand"},"control_points":[]},{"source":{"operation":"reshape","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"reshape","data":"input"},"control_points":[]}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand N Dimensions","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Num Dims"},"sink":{"operation":"Expand N Dimensions","data":"Dims to Add"},"control_points":[]},{"source":{"operation":"Expand N Dimensions","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":2651,"y":222},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"All Equal ","type":"COMPOSITE_OPERATION","position":{"x":3043,"y":452},"inputs":[{"name":"Input 1","primitive_name":"Input"},{"name":"Input 2","primitive_name":"Input"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations":[{"name":"get_shape","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":484,"y":43},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"get_shape_1","primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":451,"y":184},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":843,"y":142},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"reduce_one_dimension","primitive_name":"reduce_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":1235,"y":142},"inputs":[{"name":"input","primitive_name":"input"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"selected_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"selected_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"If Equal Shape, check sizes","type":"CONDITIONAL_OPERATION","position":{"x":1692,"y":450},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Input (1)","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"equal","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":571,"y":240},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]},{"name":"parse_integer","primitive_name":"parse_integer","type":"PRIMITIVE_OPERATION","position":{"x":1010,"y":261},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]},{"name":"sum","primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":1508,"y":245},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND"}]},{"name":"get_dimension_size","primitive_name":"get_dimension_size","type":"PRIMITIVE_OPERATION","position":{"x":1084,"y":678},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"dimension_size","primitive_name":"dimension_size","flow_state":"UNBOUND"}]},{"name":"equal_1","primitive_name":"equal","type":"PRIMITIVE_OPERATION","position":{"x":1905,"y":482},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"is_equal","primitive_name":"is_equal","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"parse_integer","data":"input"},"control_points":[]},{"source":{"operation":"parse_integer","data":"output"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Input (1)"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":1801,"y":82},"inputs":[{"name":"input","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"input","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"equal_1","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"equal_1","data":"right_operand"},"control_points":[]},{"source":{"operation":"equal_1","data":"is_equal"},"sink":{"operation":"reduce_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"reduce_one_dimension","data":"output"},"sink":{"operation":"If Equal Shape, check sizes","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input 1"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input"},"control_points":[{"x":792,"y":554}]},{"source":{"operation":"this","data":"Input 2"},"sink":{"operation":"If Equal Shape, check sizes","data":"Input (1)"},"control_points":[{"x":770,"y":596}]},{"source":{"operation":"If Equal Shape, check sizes","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}]},{"name":"Broadcast If Not Equal","type":"CONDITIONAL_OPERATION","position":{"x":3604,"y":453},"inputs":[{"name":"Is True","primitive_name":"Is True"},{"name":"Input","primitive_name":"Input"},{"name":"Goal Shape","primitive_name":"Input (1)"}],"outputs":[{"name":"Output","primitive_name":"Output","flow_state":"UNBOUND"}],"operations_if_true":[{"name":"identity","primitive_name":"identity","type":"PRIMITIVE_OPERATION","position":{"x":538,"y":97},"inputs":[{"name":"input","primitive_name":"input"}],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND"}]}],"links_if_true":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"identity","data":"input"},"control_points":[]},{"source":{"operation":"identity","data":"output"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"operations_if_false":[{"name":"broadcast_to_shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":410,"y":43},"inputs":[{"name":"target","primitive_name":"target"},{"name":"shape","primitive_name":"shape"}],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND"}]}],"links_if_false":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"this","data":"Output"},"control_points":[]}],"condition":{"name":"Is True"}}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"get_dimension_size","data":"array"},"control_points":[]},{"source":{"operation":"get_dimension_size","data":"dimension_size"},"sink":{"operation":"equal","data":"left_operand"},"control_points":[]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"equal","data":"right_operand"},"control_points":[{"x":1700,"y":427}]},{"source":{"operation":"equal","data":"is_equal"},"sink":{"operation":"Expand If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Expand If Not Equal","data":"Input"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"All Equal ","data":"Input 1"},"control_points":[]},{"source":{"operation":"All Equal ","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Is True"},"control_points":[]},{"source":{"operation":"Expand If Not Equal","data":"Output"},"sink":{"operation":"Broadcast If Not Equal","data":"Input"},"control_points":[{"x":2980,"y":63}]},{"source":{"operation":"Broadcast If Not Equal","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"get_dimension_size_1","data":"array"},"control_points":[{"x":638,"y":734}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"All Equal ","data":"Input 2"},"control_points":[{"x":477,"y":556}]},{"source":{"operation":"this","data":"Goal Shape"},"sink":{"operation":"Broadcast If Not Equal","data":"Goal Shape"},"control_points":[{"x":520,"y":599}]},{"source":{"operation":"get_dimension_size_1","data":"dimension_size"},"sink":{"operation":"Expand If Not Equal","data":"Num Dims"},"control_points":[{"x":1850,"y":147}]}]},{"name":"Broadcast Residuals to Shape","primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":5479,"y":234},"inputs":[{"name":"Target","primitive_name":"target"},{"name":"Shape","primitive_name":"shape"}],"input_order":[1,0],"outputs":[{"name":"Broadcasted Residuals","primitive_name":"result","flow_state":"UNBOUND"}]},{"name":"add","primitive_name":"add","type":"PRIMITIVE_OPERATION","position":{"x":5979,"y":41},"inputs":[{"name":"left_operand","primitive_name":"left_operand"},{"name":"right_operand","primitive_name":"right_operand"}],"outputs":[{"name":"added_result","primitive_name":"added_result","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Shape"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"multiply","data":"left_operand"},"control_points":[]},{"source":{"operation":"Broadcast Residuals to Shape","data":"Broadcasted Residuals"},"sink":{"operation":"add","data":"right_operand"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"Get Shape for Multiplied Result","data":"Input"},"control_points":[]},{"source":{"operation":"add","data":"added_result"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"multiply","data":"multiplied_result"},"sink":{"operation":"add","data":"left_operand"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"broadcast_to_shape","data":"target"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"multiply","data":"right_operand"},"control_points":[]},{"source":{"operation":"this","data":"Hidden Size"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Hidden Size"},"control_points":[{"x":389,"y":618}]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Calculate Multiply Weight Shape","data":"Input"},"control_points":[{"x":404,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[{"x":1972,"y":576}]},{"source":{"operation":"Calculate Multiply Weight Shape","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"slice_1","data":"array"},"control_points":[]},{"source":{"operation":"Get Shape for Multiplied Result","data":"Shape"},"sink":{"operation":"Expand To Goal Shape","data":"Goal Shape"},"control_points":[{"x":3888,"y":688}]},{"source":{"operation":"Expand To Goal Shape","data":"Output"},"sink":{"operation":"Broadcast Residuals to Shape","data":"Target"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"Weights","data":"shape"},"control_points":[]},{"source":{"operation":"slice_1","data":"sliced_array"},"sink":{"operation":"Bias","data":"shape"},"control_points":[]},{"source":{"operation":"Bias","data":"Output"},"sink":{"operation":"Expand To Goal Shape","data":"Input"},"control_points":[]},{"source":{"operation":"Weights","data":"Output"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]}]}],"links":[{"source":{"operation":"ReLU","data":"Output"},"sink":{"operation":"Linear Layer (layer_0)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (layer_0)","data":"Output"},"sink":{"operation":"ReLU (1)","data":"Input"},"control_points":[]},{"source":{"operation":"ReLU (1)","data":"Output"},"sink":{"operation":"Linear Layer (proj_out)","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_out)","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"this","data":"Input"},"sink":{"operation":"Linear Layer (proj_in) ","data":"Input"},"control_points":[]},{"source":{"operation":"Linear Layer (proj_in) ","data":"Output"},"sink":{"operation":"ReLU","data":"Input"},"control_points":[]}],"documentations":[]},{"name":"slice","primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1203,"y":41},"inputs":[{"name":"array","primitive_name":"array"},{"name":"dimension_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE"},{"name":"start_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE"},{"name":"end_index","data":4,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE"}],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND"}]}],"links":[{"source":{"operation":"this","data":"Input"},"sink":{"operation":"getitem_117_1106","data":"input"},"control_points":[]},{"source":{"operation":"getitem_117_1106","data":"output"},"sink":{"operation":"mlp","data":"Input"},"control_points":[]},{"source":{"operation":"mlp","data":"Output"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"this","data":"iou_scores"},"control_points":[]}]}],"links":[{"source":{"operation":"Mask Decoder Output Hypernetworks MLPs","data":"2_1152"},"sink":{"operation":"Cat hypernetworks and upscale","data":"arg 0"},"control_points":[]},{"source":{"operation":"Mask Decoder Upscale Layer Norm","data":"Output"},"sink":{"operation":"Cat hypernetworks and upscale","data":"arg1"},"control_points":[]},{"source":{"operation":"Cat hypernetworks and upscale","data":"Output"},"sink":{"operation":"this","data":"Output"},"control_points":[]},{"source":{"operation":"Mask Decoder IOU prediction head","data":"iou_scores"},"sink":{"operation":"this","data":"iou_scores"},"control_points":[]},{"source":{"operation":"Mask Decoder Transformer","data":"33_1105"},"sink":{"operation":"Mask Decoder IOU prediction head","data":"Input"},"control_points":[]},{"source":{"operation":"Mask Decoder Transformer","data":"33_1105"},"sink":{"operation":"Mask Decoder Output Hypernetworks MLPs","data":"Input"},"control_points":[]},{"source":{"operation":"Mask Decoder Transformer","data":"32_1084"},"sink":{"operation":"Mask Decoder Upscale Layer Norm","data":"image embeddings"},"control_points":[]},{"source":{"operation":"this","data":"Sparse Prompt Enbedding"},"sink":{"operation":"Shape Inputs to Target Shape","data":"Input"},"control_points":[]},{"source":{"operation":"this","data":"Positional Embedding"},"sink":{"operation":"Shape Inputs to Target Shape","data":"Input (1)"},"control_points":[]},{"source":{"operation":"this","data":"Image Embedding"},"sink":{"operation":"Shape Inputs to Target Shape","data":"Image Embeddings"},"control_points":[]},{"source":{"operation":"Shape Inputs to Target Shape","data":"unsqueeze_2_949"},"sink":{"operation":"Mask Decoder Transformer","data":"unsqueeze_2_949"},"control_points":[]},{"source":{"operation":"Shape Inputs to Target Shape","data":"Output"},"sink":{"operation":"Mask Decoder Transformer","data":"to_17_943"},"control_points":[]},{"source":{"operation":"Shape Inputs to Target Shape","data":"Output (1)"},"sink":{"operation":"Mask Decoder Transformer","data":"unsqueeze_3_952"},"control_points":[]}],"global_constants":[{"name":"Is Train","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"Is Train"},{"name":"Training Weight File Name","data":"weight","shape":[],"type":"TEXT","primitive_name":"Training Weight File Name"},{"name":"Pretrain Directory (Read Only)","data":"/public/slimsam-50-uniform","shape":[],"type":"TEXT","primitive_name":"Pretrain Directory (Read Only)"},{"name":"QTraining Weight File NameE","data":"","shape":[],"type":"TEXT","primitive_name":"QTraining Weight File NameE"},{"name":"Start From Pretrained","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"Start From Pretrained"},{"name":"Learning Rate","data":0.001,"shape":[],"type":"DECIMAL","primitive_name":"Learning Rate"},{"name":"Training Directory","data":"/REPLACE_ME","shape":[],"type":"TEXT","primitive_name":"Training Directory"}]}