{
   "name": "Hard Tanh",
   "type": "COMPOSITE_OPERATION",
   "inputs": [
     { "name": "Input", "primitive_name": "Input" },
     { "name": "max_val", "primitive_name": "Input (1)" },
     { "name": "min_val", "primitive_name": "Input (2)" }
   ],
   "outputs": [
     { "name": "Output", "primitive_name": "Output", "flow_state": "UNBOUND" }
   ],
   "description": {
     "summary": "Applies the HardTanh function element-wise.",
     "formula": "HardTanh(x) = { max_val if x > max_val, min_val if x < min_val, x otherwise }",
     "parameters": {
       "min_val": {
         "description": "Minimum value of the linear region range.",
         "type": "float",
         "default": -1.0
       },
       "max_val": {
         "description": "Maximum value of the linear region range.",
         "type": "float",
         "default": 1.0
       },
       "inplace": {
         "description": "Can optionally do the operation in-place.",
         "type": "bool",
         "default": false
       }
     },
     "deprecated_parameters": {
       "min_value": "Deprecated in favor of min_val.",
       "max_value": "Deprecated in favor of max_val."
     },
     "shape": {
       "input": "(*)",
       "output": "(*)",
       "note": "The output shape is the same as the input shape."
     }
   },
   "operations": [
     {
       "name": "get_shape",
       "primitive_name": "get_shape",
       "type": "PRIMITIVE_OPERATION",
       "position": { "x": 284, "y": 246 },
       "inputs": [
         { "name": "input", "primitive_name": "input" }
       ],
       "outputs": [
         { "name": "shape", "primitive_name": "shape", "flow_state": "UNBOUND" }
       ]
     },
     {
       "name": "Min_val and Input Comparison",
       "type": "COMPOSITE_OPERATION",
       "position": { "x": 1116, "y": 494 },
       "inputs": [
         { "name": "Input", "primitive_name": "Input" },
         { "name": "min_val", "primitive_name": "Input (1)" },
         { "name": "shape", "primitive_name": "Input (2)" }
       ],
       "subgraph_input_order": [0, 1, 2],
       "outputs": [
         { "name": "Output", "primitive_name": "Output", "flow_state": "UNBOUND" }
       ],
       "operations": [
         {
           "name": "Broadcast min_val",
           "primitive_name": "broadcast_to_shape",
           "type": "PRIMITIVE_OPERATION",
           "position": { "x": 290, "y": 97 },
           "inputs": [
             { "name": "target", "primitive_name": "target" },
             { "name": "shape", "primitive_name": "shape" }
           ],
           "outputs": [
             { "name": "result", "primitive_name": "result", "flow_state": "UNBOUND" }
           ]
         },
         {
           "name": "Less than min_val",
           "primitive_name": "less_than",
           "type": "PRIMITIVE_OPERATION",
           "position": { "x": 1079, "y": -2 },
           "inputs": [
             { "name": "left_operand", "primitive_name": "left_operand" },
             { "name": "right_operand", "primitive_name": "right_operand" }
           ],
           "outputs": [
             { "name": "is_less_than", "primitive_name": "is_less_than", "flow_state": "UNBOUND" }
           ]
         },
         {
           "name": "conditional_filter",
           "primitive_name": "conditional_filter",
           "type": "PRIMITIVE_OPERATION",
           "position": { "x": 1672, "y": 113 },
           "inputs": [
             { "name": "condition", "primitive_name": "condition" },
             { "name": "data_if_true", "primitive_name": "data_if_true" },
             { "name": "data_if_false", "primitive_name": "data_if_false" }
           ],
           "outputs": [
             { "name": "output_data", "primitive_name": "output_data", "flow_state": "UNBOUND" }
           ]
         }
       ],
       "links": [
         { "source": { "operation": "this", "data": "shape" }, "sink": { "operation": "Broadcast min_val", "data": "shape" }, "control_points": [] },
         { "source": { "operation": "this", "data": "min_val" }, "sink": { "operation": "Broadcast min_val", "data": "target" }, "control_points": [] },
         { "source": { "operation": "Broadcast min_val", "data": "result" }, "sink": { "operation": "Less than min_val", "data": "right_operand" }, "control_points": [] },
         { "source": { "operation": "Less than min_val", "data": "is_less_than" }, "sink": { "operation": "conditional_filter", "data": "condition" }, "control_points": [] },
         { "source": { "operation": "Broadcast min_val", "data": "result" }, "sink": { "operation": "conditional_filter", "data": "data_if_true" }, "control_points": [] },
         { "source": { "operation": "this", "data": "Input" }, "sink": { "operation": "Less than min_val", "data": "left_operand" }, "control_points": [] },
         { "source": { "operation": "this", "data": "Input" }, "sink": { "operation": "conditional_filter", "data": "data_if_false" }, "control_points": [] },
         { "source": { "operation": "conditional_filter", "data": "output_data" }, "sink": { "operation": "this", "data": "Output" }, "control_points": [] }
       ]
     },
     {
       "name": "Max_val and Input Comparison",
       "type": "COMPOSITE_OPERATION",
       "position": { "x": 1238, "y": 41 },
       "inputs": [
         { "name": "Input", "primitive_name": "Input" },
         { "name": "max_val", "primitive_name": "Input (1)" },
         { "name": "shape", "primitive_name": "Input (2)" }
       ],
       "outputs": [
         { "name": "Output", "primitive_name": "Output", "flow_state": "UNBOUND" },
         { "name": "cond", "primitive_name": "Output (1)", "flow_state": "UNBOUND" }
       ],
       "subgraph_output_order": [1, 0],
       "operations": [
         {
           "name": "Broadcast max_val",
           "primitive_name": "broadcast_to_shape",
           "type": "PRIMITIVE_OPERATION",
           "position": { "x": 426, "y": 98 },
           "inputs": [
             { "name": "target", "primitive_name": "target" },
             { "name": "shape", "primitive_name": "shape" }
           ],
           "outputs": [
             { "name": "result", "primitive_name": "result", "flow_state": "UNBOUND" }
           ]
         },
         {
           "name": "greater_than max",
           "primitive_name": "greater_than",
           "type": "PRIMITIVE_OPERATION",
           "position": { "x": 1127, "y": 99 },
           "inputs": [
             { "name": "left_operand", "primitive_name": "left_operand" },
             { "name": "right_operand", "primitive_name": "right_operand" }
           ],
           "outputs": [
             { "name": "is_greater_than", "primitive_name": "is_greater_than", "flow_state": "UNBOUND" }
           ]
         }
       ],
       "links": [
         { "source": { "operation": "this", "data": "max_val" }, "sink": { "operation": "Broadcast max_val", "data": "target" }, "control_points": [] },
         { "source": { "operation": "this", "data": "shape" }, "sink": { "operation": "Broadcast max_val", "data": "shape" }, "control_points": [] },
         { "source": { "operation": "this", "data": "Input" }, "sink": { "operation": "greater_than max", "data": "left_operand" }, "control_points": [] },
         { "source": { "operation": "Broadcast max_val", "data": "result" }, "sink": { "operation": "greater_than max", "data": "right_operand" }, "control_points": [] },
         { "source": { "operation": "greater_than max", "data": "is_greater_than" }, "sink": { "operation": "this", "data": "cond" }, "control_points": [] },
         { "source": { "operation": "Broadcast max_val", "data": "result" }, "sink": { "operation": "this", "data": "Output" }, "control_points": [] }
       ]
     },
     {
       "name": "conditional_filter",
       "primitive_name": "conditional_filter",
       "type": "PRIMITIVE_OPERATION",
       "position": { "x": 2551, "y": 8 },
       "inputs": [
         { "name": "condition", "primitive_name": "condition" },
         { "name": "data_if_true", "primitive_name": "data_if_true" },
         { "name": "data_if_false", "primitive_name": "data_if_false" }
       ],
       "outputs": [
         { "name": "output_data", "primitive_name": "output_data", "flow_state": "UNBOUND" }
       ]
     },
     {
       "links": [
         { "source": { "operation": "conditional_filter", "data": "output_data" }, "sink": { "operation": "this", "data": "Output" }, "control_points": [] },
         { "source": { "operation": "this", "data": "Input" }, "sink": { "operation": "get_shape", "data": "input" }, "control_points": [] },
         { "source": { "operation": "get_shape", "data": "shape" }, "sink": { "operation": "Min_val and Input Comparison", "data": "shape" }, "control_points": [] },
         { "source": { "operation": "Min_val and Input Comparison", "data": "Output" }, "sink": { "operation": "conditional_filter", "data": "data_if_false" }, "control_points": [] },
         { "source": { "operation": "get_shape", "data": "shape" }, "sink": { "operation": "Max_val and Input Comparison", "data": "shape" }, "control_points": [] },
         { "source": { "operation": "this", "data": "max_val" }, "sink": { "operation": "Max_val and Input Comparison", "data": "max_val" }, "control_points": [] },
         { "source": { "operation": "this", "data": "Input" }, "sink": { "operation": "Max_val and Input Comparison", "data": "Input" }, "control_points": [] },
         { "source": { "operation": "Max_val and Input Comparison", "data": "Output" }, "sink": { "operation": "conditional_filter", "data": "data_if_true" }, "control_points": [] },
         { "source": { "operation": "Max_val and Input Comparison", "data": "cond" }, "sink": { "operation": "conditional_filter", "data": "condition" }, "control_points": [] }
       ]
     }
   ]
 }
